function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _regeneratorRuntime(){_regeneratorRuntime=function(){return i};var s,i={},e=Object.prototype,u=e.hasOwnProperty,l=Object.defineProperty||function(e,t,r){e[t]=r.value},t="function"==typeof Symbol?Symbol:{},n=t.iterator||"@@iterator",r=t.asyncIterator||"@@asyncIterator",o=t.toStringTag||"@@toStringTag";function a(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{a({},"")}catch(s){a=function(e,t,r){return e[t]=r}}function c(e,t,r,n){var o,a,i,c,t=t&&t.prototype instanceof v?t:v,t=Object.create(t.prototype),n=new _(n||[]);return l(t,"_invoke",{value:(o=e,a=r,i=n,c=f,function(e,t){if(c===p)throw Error("Generator is already running");if(c===h){if("throw"===e)throw t;return{value:s,done:!0}}for(i.method=e,i.arg=t;;){var r=i.delegate;if(r){r=function e(t,r){var n=r.method,o=t.iterator[n];if(o===s)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=s,e(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;n=d(o,t.iterator,r.arg);if("throw"===n.type)return r.method="throw",r.arg=n.arg,r.delegate=null,y;o=n.arg;return o?o.done?(r[t.resultName]=o.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=s),r.delegate=null,y):o:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}(r,i);if(r){if(r===y)continue;return r}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if(c===f)throw c=h,i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);c=p;r=d(o,a,i);if("normal"===r.type){if(c=i.done?h:m,r.arg===y)continue;return{value:r.arg,done:i.done}}"throw"===r.type&&(c=h,i.method="throw",i.arg=r.arg)}})}),t}function d(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}i.wrap=c;var f="suspendedStart",m="suspendedYield",p="executing",h="completed",y={};function v(){}function g(){}function w(){}var t={},b=(a(t,n,function(){return this}),Object.getPrototypeOf),b=b&&b(b(C([]))),x=(b&&b!==e&&u.call(b,n)&&(t=b),w.prototype=v.prototype=Object.create(t));function E(e){["next","throw","return"].forEach(function(t){a(e,t,function(e){return this._invoke(t,e)})})}function L(i,c){var t;l(this,"_invoke",{value:function(r,n){function e(){return new c(function(e,t){!function t(e,r,n,o){var a,e=d(i[e],i,r);if("throw"!==e.type)return(r=(a=e.arg).value)&&"object"==_typeof(r)&&u.call(r,"__await")?c.resolve(r.__await).then(function(e){t("next",e,n,o)},function(e){t("throw",e,n,o)}):c.resolve(r).then(function(e){a.value=e,n(a)},function(e){return t("throw",e,n,o)});o(e.arg)}(r,n,e,t)})}return t=t?t.then(e,e):e()}})}function k(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function S(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function _(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(k,this),this.reset(!0)}function C(t){if(t||""===t){var r,e=t[n];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length))return r=-1,(e=function e(){for(;++r<t.length;)if(u.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=s,e.done=!0,e}).next=e}throw new TypeError(_typeof(t)+" is not iterable")}return l(x,"constructor",{value:g.prototype=w,configurable:!0}),l(w,"constructor",{value:g,configurable:!0}),g.displayName=a(w,o,"GeneratorFunction"),i.isGeneratorFunction=function(e){e="function"==typeof e&&e.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},i.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,w):(e.__proto__=w,a(e,o,"GeneratorFunction")),e.prototype=Object.create(x),e},i.awrap=function(e){return{__await:e}},E(L.prototype),a(L.prototype,r,function(){return this}),i.AsyncIterator=L,i.async=function(e,t,r,n,o){void 0===o&&(o=Promise);var a=new L(c(e,t,r,n),o);return i.isGeneratorFunction(t)?a:a.next().then(function(e){return e.done?e.value:a.next()})},E(x),a(x,o,"Generator"),a(x,n,function(){return this}),a(x,"toString",function(){return"[object Generator]"}),i.keys=function(e){var t,r=Object(e),n=[];for(t in r)n.push(t);return n.reverse(),function e(){for(;n.length;){var t=n.pop();if(t in r)return e.value=t,e.done=!1,e}return e.done=!0,e}},i.values=C,_.prototype={constructor:_,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=s,this.done=!1,this.delegate=null,this.method="next",this.arg=s,this.tryEntries.forEach(S),!e)for(var t in this)"t"===t.charAt(0)&&u.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=s)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var n=this;function e(e,t){return a.type="throw",a.arg=r,n.next=e,t&&(n.method="next",n.arg=s),!!t}for(var t=this.tryEntries.length-1;0<=t;--t){var o=this.tryEntries[t],a=o.completion;if("root"===o.tryLoc)return e("end");if(o.tryLoc<=this.prev){var i=u.call(o,"catchLoc"),c=u.call(o,"finallyLoc");if(i&&c){if(this.prev<o.catchLoc)return e(o.catchLoc,!0);if(this.prev<o.finallyLoc)return e(o.finallyLoc)}else if(i){if(this.prev<o.catchLoc)return e(o.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return e(o.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;0<=r;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&u.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}var a=(o=o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc?null:o)?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,y):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),y},finish:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),S(r),y}},catch:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var r,n,o=this.tryEntries[t];if(o.tryLoc===e)return"throw"===(r=o.completion).type&&(n=r.arg,S(o)),n}throw Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:C(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=s),y}},i}function asyncGeneratorStep(e,t,r,n,o,a,i){try{var c=e[a](i),s=c.value}catch(e){return void r(e)}c.done?t(s):Promise.resolve(s).then(n,o)}function _asyncToGenerator(c){return function(){var e=this,i=arguments;return new Promise(function(t,r){var n=c.apply(e,i);function o(e){asyncGeneratorStep(n,t,r,o,a,"next",e)}function a(e){asyncGeneratorStep(n,t,r,o,a,"throw",e)}o(void 0)})}}var assignUsersTrigger=document.querySelector("body").querySelectorAll(".user-assign"),search=document.querySelectorAll(".assign-users-search"),triggerIcon='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather feather-user-plus"><path d="M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path><circle cx="8.5" cy="7" r="4"></circle><line x1="20" y1="8" x2="20" y2="14"></line><line x1="23" y1="11" x2="17" y2="11"></line></svg>',assignUsersViewAction=(()=>{var t=_asyncToGenerator(_regeneratorRuntime().mark(function e(t){var r,n,o,a;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(o=t.target.closest(".user-assign"))return r=o.parentElement.querySelector(".assign-users"),assignUsersCloseGlobal(),r.classList.remove("hide"),r.classList.add("show"),n=o.dataset.projectid,o=o.dataset.cardid,e.next=10,getUsers(n,o);e.next=12;break;case 10:(n=e.sent)&&!0===n.success&&(r.querySelector(".assign-users-select").innerHTML=null==n||null==(o=n.data)?void 0:o.users,a=r.querySelectorAll(".assign-user"))&&a.forEach(function(e){e.addEventListener("click",_assignUsers)});case 12:case"end":return e.stop()}},e)}));return function(e){return t.apply(this,arguments)}})(),getUsers=(()=>{var r=_asyncToGenerator(_regeneratorRuntime().mark(function e(t,r){var n;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(n=new FormData).append("action","get_assign_users"),n.append("projectID",t),n.append("cardID",r),n.append("security",myAjax.security),e.next=7,fetch(myAjax.ajaxurl,{method:"POST",body:n});case 7:return n=e.sent,e.abrupt("return",n.json());case 9:case"end":return e.stop()}},e)}));return function(e,t){return r.apply(this,arguments)}})(),assignUsersCloseGlobal=function(){document.querySelectorAll(".assign-users").forEach(function(e){e.classList.remove("show"),e.classList.add("hide")})},assignUsersViewClose=function(e){(e.target.closest(".user-assign")||e.target.closest(".assign-users"))&&!e.target.closest(".assign-users-close")||assignUsersCloseGlobal()},searchUsers=function(e){var n=e.currentTarget.value.toLowerCase(),e=e.currentTarget.parentElement.querySelectorAll(".assign-user");e&&e.forEach(function(e){var t=e.querySelector(".assign-user-name").innerHTML.toLowerCase(),r=n.toLowerCase();""===r||-1!==t.indexOf(r)?e.classList.remove("hide"):e.classList.add("hide")})},removeUser=function(e,t){var r=e.querySelectorAll(".user-assign .assign-user"),n=e.querySelector(".user-assign");r&&(r.forEach(function(e){t===e.dataset.id&&e.remove()}),0===e.querySelectorAll(".user-assign .assign-user").length)&&n.classList.remove("hasUsers")},_assignUsers=(()=>{var t=_asyncToGenerator(_regeneratorRuntime().mark(function e(t){var r,n,o,a,i,c,s;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.currentTarget,n=r.dataset.id,o=null!=(o=r.closest(".kanban-card"))?o:document.querySelector(".kanban-card-view"),a=o.querySelector(".user-assign"),a=void 0!==o.dataset.cardId?o.dataset.cardId:a.dataset.cardid,(i=r.cloneNode(!0)).removeEventListener("click",_assignUsers),(c=i.querySelector(".assign-user-name"))&&c.remove(),(c=new FormData).append("action","assign_users_to_task"),c.append("userID",n),c.append("cardID",a),c.append("security",myAjax.security),e.prev=14,e.next=17,fetch(myAjax.ajaxurl,{method:"POST",body:c});case 17:return c=e.sent,e.next=20,c.json();case 20:(s=e.sent)&&!1!==s.success?r.classList.contains("selected")?(r.classList.remove("selected"),s=document.querySelector('.kanban-card[data-card-id="'.concat(a,'"]')),removeUser(o,n),removeUser(s,n)):(r.classList.add("selected"),(s=o.querySelector(".user-assign")).classList.contains("hasUsers")||s.classList.add("hasUsers"),s.prepend(i),o.classList.contains("kanban-card-view")&&(s=document.querySelector('.kanban-card[data-card-id="'.concat(a,'"]')),(s=s.querySelector(".user-assign")).classList.contains("hasUsers")||s.classList.add("hasUsers"),s.prepend(i.cloneNode(!0)))):console.error("Error user assign"),e.next=27;break;case 24:e.prev=24,e.t0=e.catch(14),console.error("AJAX error",e.t0);case 27:case"end":return e.stop()}},e,null,[[14,24]])}));return function(e){return t.apply(this,arguments)}})(),assignUsersCardView=function(e){e=document.querySelector('.kanban-card[data-card-id="'.concat(e.detail.cardID,'"]')).querySelector(".user-assign").cloneNode(!0);e.addEventListener("click",assignUsersViewAction),document.querySelector(".kanban-card-view").querySelector(".board_members_title").after(e)},assignUsersCardViewDelete=function(e){var t=document.querySelector(".kanban-card-view").querySelector(".user-assign");t&&t.remove()},copyButton=(search&&search.forEach(function(e){e.addEventListener("keyup",searchUsers)}),document.addEventListener("click",assignUsersViewClose),document.body.addEventListener("click",assignUsersViewAction),document.addEventListener("cardViewOpened",assignUsersCardView),document.addEventListener("cardViewClosed",assignUsersCardViewDelete),document.querySelector(".sidebar-btn-copy")),cardView=function(e){var t;!e.target.closest(".kanban-card")||e.target.closest(".dynamic-select")||e.target.closest(".card-priority")||e.target.closest(".card-status")||e.target.closest(".delete-card-btn")||e.target.closest(".card-title")||e.target.closest("a")||e.target.closest(".user-assign")||e.target.closest(".assign-users")||(t=e.target.closest(".kanban-card").dataset.cardId,t=new CustomEvent("cardViewOpened",{detail:{cardID:t}}),document.dispatchEvent(t)),(e.target.matches(".kanban-card-view-close")||e.target.matches(".kanban-card-view"))&&(t=new CustomEvent("cardViewClosed"),document.dispatchEvent(t))},cardViewOpen=(document.addEventListener("click",cardView),function(e){var t=document.querySelector('.kanban-card[data-card-Id="'.concat(e.detail.cardID,'"]')),e=e.detail.cardID,r=t.dataset.userAdmin,n=t.dataset.userCreation,o=document.querySelector(".kanban-comment-save"),a=document.querySelector(".kanban-description-save"),i=document.querySelector(".kanban-card-view"),c=t.querySelector(".card-title").innerHTML,s=document.querySelector(".kanban-card-view").querySelector(".card-title"),o=(i.dataset.cardId=e,o.dataset.cardId=e,a.dataset.cardId=e,a.dataset.userAdmin=r,a.dataset.userCreation=n,s.innerHTML=c,s.dataset.cardId=e,t.querySelector(".card-priority").selectedIndex),r=t.querySelector(".card-status").selectedIndex,a=i.querySelector(".card-priority"),n=i.querySelector(".card-status"),c=t.querySelector(".priority-wrap .dynamic-select-current-item").cloneNode(!0),s=t.querySelector(".status-wrap .dynamic-select-current-item").cloneNode(!0),e=i.querySelector(".priority-wrap .dynamic-select-current"),t=i.querySelector(".status-wrap .dynamic-select-current");a.selectedIndex=o,n.selectedIndex=r,e.replaceChildren(c),t.replaceChildren(s),i.classList.remove("hide"),i.classList.add("show"),document.querySelector("body").style.overflow="hidden"}),cardViewClose=function(){var e=document.querySelector(".kanban-card-view"),t=document.querySelector(".kanban-comments"),e=(e.classList.remove("show"),e.classList.add("hide"),document.querySelector("body").style.overflow="visible",document.querySelector(".comment-error")),e=(e&&e.remove(),new URL(window.location));e.searchParams.delete("cardIDView"),window.history.replaceState({},"",e),t.innerHTML=""},openCardViewUrl=function(e){var t,r=new URLSearchParams(window.location.search).get("cardIDView");r&&(t=new CustomEvent("cardViewOpened",{detail:{cardID:r}}),setTimeout(function(){document.dispatchEvent(t)},200))},copyCardLink=function(e){e.preventDefault();var e=e.currentTarget.closest(".kanban-card-view").dataset.cardId,t=new URL(window.location.href),r=(t.searchParams.set("cardIDView",e),t.toString());navigator.clipboard&&window.isSecureContext?null!=(e=navigator)&&null!=(e=e.clipboard)&&e.writeText(r).then(showCopyMessage).catch(function(e){console.error("Error Copy Url: ",e),fallbackCopyTextToClipboard(r)}):fallbackCopyTextToClipboard(r)};function fallbackCopyTextToClipboard(e){var t=document.createElement("textarea");t.value=e,t.style.position="fixed",t.style.top="-9999px",document.body.appendChild(t),t.focus(),t.select();try{document.execCommand("copy")?showCopyMessage():console.error("Error Copy Url!")}catch(e){console.error("Error Copy Url: ",e)}document.body.removeChild(t)}function showCopyMessage(){var e=document.getElementById("copyMessage");e&&(e.style.display="block",setTimeout(function(){e.style.display="none"},3e3))}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _regeneratorRuntime(){_regeneratorRuntime=function(){return i};var s,i={},e=Object.prototype,u=e.hasOwnProperty,l=Object.defineProperty||function(e,t,r){e[t]=r.value},t="function"==typeof Symbol?Symbol:{},n=t.iterator||"@@iterator",r=t.asyncIterator||"@@asyncIterator",o=t.toStringTag||"@@toStringTag";function a(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{a({},"")}catch(s){a=function(e,t,r){return e[t]=r}}function c(e,t,r,n){var o,a,i,c,t=t&&t.prototype instanceof v?t:v,t=Object.create(t.prototype),n=new _(n||[]);return l(t,"_invoke",{value:(o=e,a=r,i=n,c=f,function(e,t){if(c===p)throw Error("Generator is already running");if(c===h){if("throw"===e)throw t;return{value:s,done:!0}}for(i.method=e,i.arg=t;;){var r=i.delegate;if(r){r=function e(t,r){var n=r.method,o=t.iterator[n];if(o===s)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=s,e(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;n=d(o,t.iterator,r.arg);if("throw"===n.type)return r.method="throw",r.arg=n.arg,r.delegate=null,y;o=n.arg;return o?o.done?(r[t.resultName]=o.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=s),r.delegate=null,y):o:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}(r,i);if(r){if(r===y)continue;return r}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if(c===f)throw c=h,i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);c=p;r=d(o,a,i);if("normal"===r.type){if(c=i.done?h:m,r.arg===y)continue;return{value:r.arg,done:i.done}}"throw"===r.type&&(c=h,i.method="throw",i.arg=r.arg)}})}),t}function d(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}i.wrap=c;var f="suspendedStart",m="suspendedYield",p="executing",h="completed",y={};function v(){}function g(){}function w(){}var t={},b=(a(t,n,function(){return this}),Object.getPrototypeOf),b=b&&b(b(C([]))),x=(b&&b!==e&&u.call(b,n)&&(t=b),w.prototype=v.prototype=Object.create(t));function E(e){["next","throw","return"].forEach(function(t){a(e,t,function(e){return this._invoke(t,e)})})}function L(i,c){var t;l(this,"_invoke",{value:function(r,n){function e(){return new c(function(e,t){!function t(e,r,n,o){var a,e=d(i[e],i,r);if("throw"!==e.type)return(r=(a=e.arg).value)&&"object"==_typeof(r)&&u.call(r,"__await")?c.resolve(r.__await).then(function(e){t("next",e,n,o)},function(e){t("throw",e,n,o)}):c.resolve(r).then(function(e){a.value=e,n(a)},function(e){return t("throw",e,n,o)});o(e.arg)}(r,n,e,t)})}return t=t?t.then(e,e):e()}})}function k(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function S(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function _(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(k,this),this.reset(!0)}function C(t){if(t||""===t){var r,e=t[n];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length))return r=-1,(e=function e(){for(;++r<t.length;)if(u.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=s,e.done=!0,e}).next=e}throw new TypeError(_typeof(t)+" is not iterable")}return l(x,"constructor",{value:g.prototype=w,configurable:!0}),l(w,"constructor",{value:g,configurable:!0}),g.displayName=a(w,o,"GeneratorFunction"),i.isGeneratorFunction=function(e){e="function"==typeof e&&e.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},i.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,w):(e.__proto__=w,a(e,o,"GeneratorFunction")),e.prototype=Object.create(x),e},i.awrap=function(e){return{__await:e}},E(L.prototype),a(L.prototype,r,function(){return this}),i.AsyncIterator=L,i.async=function(e,t,r,n,o){void 0===o&&(o=Promise);var a=new L(c(e,t,r,n),o);return i.isGeneratorFunction(t)?a:a.next().then(function(e){return e.done?e.value:a.next()})},E(x),a(x,o,"Generator"),a(x,n,function(){return this}),a(x,"toString",function(){return"[object Generator]"}),i.keys=function(e){var t,r=Object(e),n=[];for(t in r)n.push(t);return n.reverse(),function e(){for(;n.length;){var t=n.pop();if(t in r)return e.value=t,e.done=!1,e}return e.done=!0,e}},i.values=C,_.prototype={constructor:_,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=s,this.done=!1,this.delegate=null,this.method="next",this.arg=s,this.tryEntries.forEach(S),!e)for(var t in this)"t"===t.charAt(0)&&u.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=s)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var n=this;function e(e,t){return a.type="throw",a.arg=r,n.next=e,t&&(n.method="next",n.arg=s),!!t}for(var t=this.tryEntries.length-1;0<=t;--t){var o=this.tryEntries[t],a=o.completion;if("root"===o.tryLoc)return e("end");if(o.tryLoc<=this.prev){var i=u.call(o,"catchLoc"),c=u.call(o,"finallyLoc");if(i&&c){if(this.prev<o.catchLoc)return e(o.catchLoc,!0);if(this.prev<o.finallyLoc)return e(o.finallyLoc)}else if(i){if(this.prev<o.catchLoc)return e(o.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return e(o.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;0<=r;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&u.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}var a=(o=o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc?null:o)?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,y):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),y},finish:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),S(r),y}},catch:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var r,n,o=this.tryEntries[t];if(o.tryLoc===e)return"throw"===(r=o.completion).type&&(n=r.arg,S(o)),n}throw Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:C(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=s),y}},i}function asyncGeneratorStep(e,t,r,n,o,a,i){try{var c=e[a](i),s=c.value}catch(e){return void r(e)}c.done?t(s):Promise.resolve(s).then(n,o)}function _asyncToGenerator(c){return function(){var e=this,i=arguments;return new Promise(function(t,r){var n=c.apply(e,i);function o(e){asyncGeneratorStep(n,t,r,o,a,"next",e)}function a(e){asyncGeneratorStep(n,t,r,o,a,"throw",e)}o(void 0)})}}document.addEventListener("cardViewOpened",cardViewOpen),document.addEventListener("cardViewClosed",cardViewClose),document.addEventListener("DOMContentLoaded",openCardViewUrl),null!=copyButton&&copyButton.addEventListener("click",copyCardLink);var commentIcon='<svg title="Card has Comments" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="#808890" class="size-6">\n\t\t\t\t\t\t<path stroke-linecap="round" stroke-linejoin="round" d="M7.5 8.25h9m-9 3H12m-9.75 1.51c0 1.6 1.123 2.994 2.707 3.227 1.129.166 2.27.293 3.423.379.35.026.67.21.865.501L12 21l2.755-4.133a1.14 1.14 0 0 1 .865-.501 48.172 48.172 0 0 0 3.423-.379c1.584-.233 2.707-1.626 2.707-3.228V6.741c0-1.602-1.123-2.995-2.707-3.228A48.394 48.394 0 0 0 12 3c-2.392 0-4.744.175-7.043.513C3.373 3.746 2.25 5.14 2.25 6.741v6.018Z" />\n\t\t\t\t\t</svg>',commentEditors=[],editor=new EditorJS({holder:"kanban-comment-editor-js",minHeight:100,placeholder:"Post a comment...",tools:{Marker:{class:Marker,inlineToolbar:!0,shortcut:"CMD+SHIFT+M"},image:{class:SimpleImage,inlineToolbar:!0,config:{placeholder:"Paste image URL"}},code:{class:CodeTool,shortcut:"CMD+SHIFT+C"}},data:{}}),createEditorsPromise=(()=>{var e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(Array.from(document.querySelectorAll(".kanban-comment-text")).map((()=>{var t=_asyncToGenerator(_regeneratorRuntime().mark(function e(t){var r,n,o;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.id,n=t.dataset.content,commentEditors.length&&(commentEditors.forEach(function(e){e.destroy()}),commentEditors=[]),r)return o=new EditorJS({holder:r,readOnly:!0,minHeight:0,defaultBlock:"defaultBlock",tools:{Marker:{class:Marker,inlineToolbar:!0,shortcut:"CMD+SHIFT+M"},image:{class:SimpleImage,inlineToolbar:["link"]},code:{class:CodeTool,shortcut:"CMD+SHIFT+C"},defaultBlock:DefaultBlock},data:JSON.parse(n)}),e.next=7,o.isReady;e.next=8;break;case 7:commentEditors.push(o);case 8:case"end":return e.stop()}},e)}));return function(e){return t.apply(this,arguments)}})()));case 2:return e.abrupt("return",commentEditors);case 3:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}})(),findEditor=function(e,t){if(e.length)return e.filter(function(e){if(void 0!==e&&void 0!==e.configuration)return e.configuration.holder===t})},comments=function(e){e.preventDefault();var o=e.target.dataset.cardId,a=new FormData;editor.save().then((()=>{var t=_asyncToGenerator(_regeneratorRuntime().mark(function e(t){var r,n;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(0===t.blocks.length)return e.abrupt("return");e.next=2;break;case 2:return a.append("action","stk_card_comments"),a.append("cardId",o),a.append("security",myAjax.security),a.append("comment",JSON.stringify(t,null,4)),e.next=8,fetch(myAjax.ajaxurl,{method:"POST",body:a});case 8:return r=e.sent,e.next=11,r.json();case 11:(r=e.sent)&&!0===r.success&&(n=document.querySelector('[data-card-id="'.concat(o,'"]')),getComments(o),editor.clear(),(n=n.querySelector(".card-svgs")).innerHTML.includes(commentIcon)||(n.innerHTML+=commentIcon));case 13:case"end":return e.stop()}},e)}));return function(e){return t.apply(this,arguments)}})())},getComments=(()=>{var t=_asyncToGenerator(_regeneratorRuntime().mark(function e(t){var r,n,o,a,i;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(o=new FormData).append("action","stk_get_comments"),o.append("cardId",t),o.append("security",myAjax.security),r=document.querySelector(".kanban-comments"),(n=document.createElement("div")).classList.add("loader"),r.append(n),e.next=10,fetch(myAjax.ajaxurl,{method:"POST",body:o});case 10:return n=e.sent,e.next=13,n.json();case 13:if(o=e.sent,r.innerHTML="",o&&!0===o.success)if(o.data.comments){if(r.innerHTML=o.data.comments,0!==document.querySelectorAll(".kanban-comment-text").length)return e.next=22,createEditorsPromise();e.next=32}else e.next=34;else e.next=36;break;case 22:a=e.sent,i=function(e){e=findEditor(a,"comment_"+String(e.detail.commentID));void 0!==e[0]&&e[0].readOnly.toggle("",!0)},document.removeEventListener("editMode",i),document.addEventListener("editMode",i),i=function(e){e=findEditor(a,"comment_"+String(e.detail.commentID));void 0!==e[0]&&e[0].readOnly.toggle()},document.removeEventListener("discardMode",i),document.addEventListener("discardMode",i),i=function(r){var e=findEditor(a,"comment_"+String(r.detail.commentID));void 0!==e[0]&&e[0].save().then((()=>{var t=_asyncToGenerator(_regeneratorRuntime().mark(function e(t){return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(0===t.blocks.length)return e.abrupt("return");e.next=2;break;case 2:commentsAction("",!0,r.detail.commentID,JSON.stringify(t,null,4));case 3:case"end":return e.stop()}},e)}));return function(e){return t.apply(this,arguments)}})())},document.removeEventListener("commentEdited",i),document.addEventListener("commentEdited",i);case 32:e.next=36;break;case 34:document.querySelector(".no-comments")||((i=document.createElement("p")).classList.add("no-comments"),i.innerHTML="Currently, there are no comments",r.append(i));case 36:case"end":return e.stop()}},e)}));return function(e){return t.apply(this,arguments)}})(),commentsAction=(()=>{var t=_asyncToGenerator(_regeneratorRuntime().mark(function e(t){var r,n,o,a,i,c,s,u,l,d,f,m,p,h,y=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=1<y.length&&void 0!==y[1]&&y[1],n=2<y.length&&void 0!==y[2]?y[2]:null,o=3<y.length&&void 0!==y[3]?y[3]:null,a=t?t.target.matches(".kanban-comment-delete"):"",i=t?t.target.matches(".kanban-comment-edit"):"",c=t?t.target.matches(".kanban-comment-edit-save"):"",s=null,a)return e.next=10,Swal.fire({title:"Delete Comment?",text:"Are you sure that you want to delete this comment?",icon:"warning",showDenyButton:!0,confirmButtonText:"Delete",denyButtonText:"Cancel",customClass:{confirmButton:"del-btn",denyButton:"cancel-btn"}});e.next=11;break;case 10:s=e.sent;case 11:if(i)return u=t.target.dataset.commentId,u=new CustomEvent("editMode",{detail:{commentID:u}}),document.dispatchEvent(u),e.abrupt("return");e.next=16;break;case 16:if(c)return u=t.target.dataset.commentId,l=new CustomEvent("commentEdited",{detail:{commentID:u}}),document.dispatchEvent(l),e.abrupt("return");e.next=21;break;case 21:if(a&&s.isConfirmed||r)return l=new FormData,d=t?t.target.dataset.commentId:n,l.append("action","stk_comments_actions"),l.append("commentAction",a?"delete":"edit"),l.append("commentID",d),l.append("security",myAjax.security),null!==l&&l.append("comment",o),e.next=31,fetch(myAjax.ajaxurl,{method:"POST",body:l});e.next=36;break;case 31:return f=e.sent,e.next=34,f.json();case 34:(f=e.sent)&&!0===f.success&&(a?(p=t.target.closest(".kanban-comment"),m=p.dataset.userId,h=p.dataset.cardId,p.remove(),document.querySelectorAll('.kanban-comments [data-user-id="'.concat(m,'"]')).length||document.querySelector('.kanban-card[data-card-id="'.concat(h,'"]')).querySelector('.card-members [data-user="'.concat(m,'"]')).remove(),0===document.querySelectorAll(".kanban-comment").length&&(p=document.createElement("p"),h=document.querySelector(".kanban-comments"),p.classList.add("no-comments"),p.innerHTML="Currently, there are no comments",h.append(p))):discardEditMode("",d));case 36:case"end":return e.stop()}},e)}));return function(e){return t.apply(this,arguments)}})(),editMode=function(e){var e="#comment_"+String(e.detail.commentID),t=document.querySelector(e),e=document.querySelector(e).parentElement;e.querySelector(".kanban-comment-buttons-edit-mode").style.display="block",e.querySelector(".kanban-comment-buttons").style.display="none",t.classList.add("edit-mode")},discardEditMode=function(e){var t,r,n=1<arguments.length&&void 0!==arguments[1]&&arguments[1];(e?e.target.matches(".kanban-comment-discard"):n)&&(r="#comment_"+String(e?e.target.dataset.commentId:n),t=document.querySelector(r),(r=document.querySelector(r).parentElement).querySelector(".kanban-comment-buttons-edit-mode").style.display="none",r.querySelector(".kanban-comment-buttons").style.display="block",t.classList.remove("edit-mode"),r=new CustomEvent("discardMode",{detail:{commentID:e?e.target.dataset.commentId:n}}),document.dispatchEvent(r))},commentsSave=(document.addEventListener("cardViewOpened",function(e){return getComments(e.detail.cardID)}),document.addEventListener("cardViewClosed",function(e){return editor.clear()}),document.querySelector(".kanban-comment-save"));function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _regeneratorRuntime(){_regeneratorRuntime=function(){return i};var s,i={},e=Object.prototype,u=e.hasOwnProperty,l=Object.defineProperty||function(e,t,r){e[t]=r.value},t="function"==typeof Symbol?Symbol:{},n=t.iterator||"@@iterator",r=t.asyncIterator||"@@asyncIterator",o=t.toStringTag||"@@toStringTag";function a(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{a({},"")}catch(s){a=function(e,t,r){return e[t]=r}}function c(e,t,r,n){var o,a,i,c,t=t&&t.prototype instanceof v?t:v,t=Object.create(t.prototype),n=new _(n||[]);return l(t,"_invoke",{value:(o=e,a=r,i=n,c=f,function(e,t){if(c===p)throw Error("Generator is already running");if(c===h){if("throw"===e)throw t;return{value:s,done:!0}}for(i.method=e,i.arg=t;;){var r=i.delegate;if(r){r=function e(t,r){var n=r.method,o=t.iterator[n];if(o===s)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=s,e(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;n=d(o,t.iterator,r.arg);if("throw"===n.type)return r.method="throw",r.arg=n.arg,r.delegate=null,y;o=n.arg;return o?o.done?(r[t.resultName]=o.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=s),r.delegate=null,y):o:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}(r,i);if(r){if(r===y)continue;return r}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if(c===f)throw c=h,i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);c=p;r=d(o,a,i);if("normal"===r.type){if(c=i.done?h:m,r.arg===y)continue;return{value:r.arg,done:i.done}}"throw"===r.type&&(c=h,i.method="throw",i.arg=r.arg)}})}),t}function d(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}i.wrap=c;var f="suspendedStart",m="suspendedYield",p="executing",h="completed",y={};function v(){}function g(){}function w(){}var t={},b=(a(t,n,function(){return this}),Object.getPrototypeOf),b=b&&b(b(C([]))),x=(b&&b!==e&&u.call(b,n)&&(t=b),w.prototype=v.prototype=Object.create(t));function E(e){["next","throw","return"].forEach(function(t){a(e,t,function(e){return this._invoke(t,e)})})}function L(i,c){var t;l(this,"_invoke",{value:function(r,n){function e(){return new c(function(e,t){!function t(e,r,n,o){var a,e=d(i[e],i,r);if("throw"!==e.type)return(r=(a=e.arg).value)&&"object"==_typeof(r)&&u.call(r,"__await")?c.resolve(r.__await).then(function(e){t("next",e,n,o)},function(e){t("throw",e,n,o)}):c.resolve(r).then(function(e){a.value=e,n(a)},function(e){return t("throw",e,n,o)});o(e.arg)}(r,n,e,t)})}return t=t?t.then(e,e):e()}})}function k(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function S(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function _(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(k,this),this.reset(!0)}function C(t){if(t||""===t){var r,e=t[n];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length))return r=-1,(e=function e(){for(;++r<t.length;)if(u.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=s,e.done=!0,e}).next=e}throw new TypeError(_typeof(t)+" is not iterable")}return l(x,"constructor",{value:g.prototype=w,configurable:!0}),l(w,"constructor",{value:g,configurable:!0}),g.displayName=a(w,o,"GeneratorFunction"),i.isGeneratorFunction=function(e){e="function"==typeof e&&e.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},i.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,w):(e.__proto__=w,a(e,o,"GeneratorFunction")),e.prototype=Object.create(x),e},i.awrap=function(e){return{__await:e}},E(L.prototype),a(L.prototype,r,function(){return this}),i.AsyncIterator=L,i.async=function(e,t,r,n,o){void 0===o&&(o=Promise);var a=new L(c(e,t,r,n),o);return i.isGeneratorFunction(t)?a:a.next().then(function(e){return e.done?e.value:a.next()})},E(x),a(x,o,"Generator"),a(x,n,function(){return this}),a(x,"toString",function(){return"[object Generator]"}),i.keys=function(e){var t,r=Object(e),n=[];for(t in r)n.push(t);return n.reverse(),function e(){for(;n.length;){var t=n.pop();if(t in r)return e.value=t,e.done=!1,e}return e.done=!0,e}},i.values=C,_.prototype={constructor:_,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=s,this.done=!1,this.delegate=null,this.method="next",this.arg=s,this.tryEntries.forEach(S),!e)for(var t in this)"t"===t.charAt(0)&&u.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=s)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var n=this;function e(e,t){return a.type="throw",a.arg=r,n.next=e,t&&(n.method="next",n.arg=s),!!t}for(var t=this.tryEntries.length-1;0<=t;--t){var o=this.tryEntries[t],a=o.completion;if("root"===o.tryLoc)return e("end");if(o.tryLoc<=this.prev){var i=u.call(o,"catchLoc"),c=u.call(o,"finallyLoc");if(i&&c){if(this.prev<o.catchLoc)return e(o.catchLoc,!0);if(this.prev<o.finallyLoc)return e(o.finallyLoc)}else if(i){if(this.prev<o.catchLoc)return e(o.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return e(o.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;0<=r;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&u.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}var a=(o=o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc?null:o)?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,y):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),y},finish:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),S(r),y}},catch:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var r,n,o=this.tryEntries[t];if(o.tryLoc===e)return"throw"===(r=o.completion).type&&(n=r.arg,S(o)),n}throw Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:C(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=s),y}},i}function asyncGeneratorStep(e,t,r,n,o,a,i){try{var c=e[a](i),s=c.value}catch(e){return void r(e)}c.done?t(s):Promise.resolve(s).then(n,o)}function _asyncToGenerator(c){return function(){var e=this,i=arguments;return new Promise(function(t,r){var n=c.apply(e,i);function o(e){asyncGeneratorStep(n,t,r,o,a,"next",e)}function a(e){asyncGeneratorStep(n,t,r,o,a,"throw",e)}o(void 0)})}}null!=commentsSave&&commentsSave.addEventListener("click",comments),document.addEventListener("editMode",editMode),document.addEventListener("click",commentsAction),document.addEventListener("click",discardEditMode);var _document$getElementB,_document,descriptionIcon='<svg title="Card has Comments" width="14" height="18" viewBox="0 0 14 18" fill="none" xmlns="http://www.w3.org/2000/svg">\n\t\t\t\t\t<path d="M13.25 10.875V8.6875C13.25 7.94158 12.9537 7.22621 12.4262 6.69876C11.8988 6.17132 11.1834 5.875 10.4375 5.875H9.1875C8.93886 5.875 8.7004 5.77623 8.52459 5.60041C8.34877 5.4246 8.25 5.18614 8.25 4.9375V3.6875C8.25 2.94158 7.95368 2.22621 7.42624 1.69876C6.89879 1.17132 6.18342 0.875 5.4375 0.875H3.875M3.875 11.5H10.125M3.875 14H7M5.75 0.875H1.6875C1.17 0.875 0.75 1.295 0.75 1.8125V16.1875C0.75 16.705 1.17 17.125 1.6875 17.125H12.3125C12.83 17.125 13.25 16.705 13.25 16.1875V8.375C13.25 6.38588 12.4598 4.47822 11.0533 3.0717C9.64678 1.66518 7.73912 0.875 5.75 0.875Z" stroke="#808890" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path>\n\t\t\t\t</svg>',checkForEmptyObject=function(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0},descriptionEditors=[],createEditorsPromiseDescription=(()=>{var e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(Array.from(document.querySelectorAll(".card-description")).map((()=>{var t=_asyncToGenerator(_regeneratorRuntime().mark(function e(t){var r,n,o;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(o=t.id,r=JSON.parse(t.dataset.description),descriptionEditors.length&&(descriptionEditors.forEach(function(e){e.destroy()}),descriptionEditors=[]),o)return n=new EditorJS({holder:o,readOnly:!0,minHeight:100,defaultBlock:"defaultBlock",tools:{Marker:{class:Marker,inlineToolbar:!0,shortcut:"CMD+SHIFT+M"},image:{class:SimpleImage,inlineToolbar:["link"]},code:{class:CodeTool,shortcut:"CMD+SHIFT+C"},defaultBlock:{class:DefaultBlock}},data:r}),!0!==checkForEmptyObject(r)&&0!==r.blocks.length||((o=document.createElement("span")).innerHTML="Add a description",o.classList.add("description-placeholder"),t.before(o)),e.next=8,n.isReady;e.next=9;break;case 8:descriptionEditors.push(n);case 9:case"end":return e.stop()}},e)}));return function(e){return t.apply(this,arguments)}})()));case 2:return e.abrupt("return",descriptionEditors);case 3:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}})(),descriptionEditor=new EditorJS({holder:"description-editor-js",minHeight:100,placeholder:"Click to Add a description...",readOnly:!0,tools:{Marker:{class:Marker,inlineToolbar:!0,shortcut:"CMD+SHIFT+M"},image:{class:SimpleImage,inlineToolbar:!0,config:{placeholder:"Paste image URL"}},code:{class:CodeTool,shortcut:"CMD+SHIFT+C"}},data:{}}),activeDescriptionEditor=function(e){var t=document.querySelector(".kanban-card-view-description-editor"),r=null==(r=document)?void 0:r.querySelector(".kanban-description-save"),n=null==r?void 0:r.dataset.userAdmin,o=null==r?void 0:r.dataset.userCreation;e.target.closest(".kanban-card-view-description-editor")?t.classList.contains("active")||!o&&!n||(t.classList.add("active"),descriptionEditor.readOnly.toggle(),r.style.display="inline-block"):null!=t&&t.classList.contains("active")&&!e.target.matches(".kanban-description-save")&&(t.classList.remove("active"),descriptionEditor.readOnly.toggle(),r.style.display="none")},updateDescription=function(e){var a,i;e.target.matches(".kanban-description-save")&&(e.preventDefault(),a=e.target.dataset.cardId,i=new FormData,descriptionEditor.save().then((()=>{var t=_asyncToGenerator(_regeneratorRuntime().mark(function e(t){var n,r,o;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i.append("action","stk_card_description_save"),i.append("cardId",a),i.append("security",myAjax.security),i.append("description",JSON.stringify(t,null,4)),e.next=6,fetch(myAjax.ajaxurl,{method:"POST",body:i});case 6:return r=e.sent,e.next=9,r.json();case 9:(n=e.sent)&&!0===n.success&&(0!==descriptionEditors.length&&descriptionEditors.map(function(e){var t,r=e.configuration.holder.split("-");parseInt(r[r.length-1])==a&&((t=(r=document.querySelector('[data-card-id="'.concat(a,'"]'))).querySelector(".card-svgs .description_svg")).innerHTML.includes(descriptionIcon)||(t.innerHTML+=descriptionIcon),r.querySelector(".card-description").dataset.description=n.data.description,t=JSON.parse(n.data.description),e.render(t),r=document.querySelector(".kanban-card-view-description-editor"),e=document.querySelector(".kanban-description-save"),r.classList.remove("active"),descriptionEditor.readOnly.toggle(),e.style.display="none")}),r=document.querySelector('[data-card-id="'.concat(a,'"]')),(o=r.querySelector(".description-placeholder"))&&o.remove(),0===JSON.parse(n.data.description).blocks.length)&&((o=document.createElement("span")).innerHTML="Add a description",o.classList.add("description-placeholder"),r.querySelector(".card-description").before(o));case 11:case"end":return e.stop()}},e)}));return function(e){return t.apply(this,arguments)}})()))},initDescriptionEditors=(()=>{var e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,createEditorsPromiseDescription();case 2:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}})(),renderDescription=(initDescriptionEditors(),function(e){console.log(e.detail.cardID);e=document.querySelector('[data-card-id="'.concat(e.detail.cardID,'"]')).querySelector(".card-description").dataset.description;(e=JSON.parse(e))&&!checkForEmptyObject(e)?descriptionEditor.render(e):descriptionEditor.clear()}),initDescriptionEditorCardAdded=function(e){var e=e.detail.cardID,e=document.querySelector('[data-card-id="'.concat(e,'"]')).querySelector(".card-description"),t=new EditorJS({holder:e.id,readOnly:!0,minHeight:100,defaultBlock:!1,tools:{Marker:{class:Marker,inlineToolbar:!0,shortcut:"CMD+SHIFT+M"},image:{class:SimpleImage,inlineToolbar:["link"]},code:{class:CodeTool,shortcut:"CMD+SHIFT+C"}},data:{}}),r=document.createElement("span");r.innerHTML="Add a description",r.classList.add("description-placeholder"),e.before(r),descriptionEditors.push(t)};function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _regeneratorRuntime(){_regeneratorRuntime=function(){return i};var s,i={},e=Object.prototype,u=e.hasOwnProperty,l=Object.defineProperty||function(e,t,r){e[t]=r.value},t="function"==typeof Symbol?Symbol:{},n=t.iterator||"@@iterator",r=t.asyncIterator||"@@asyncIterator",o=t.toStringTag||"@@toStringTag";function a(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{a({},"")}catch(s){a=function(e,t,r){return e[t]=r}}function c(e,t,r,n){var o,a,i,c,t=t&&t.prototype instanceof v?t:v,t=Object.create(t.prototype),n=new _(n||[]);return l(t,"_invoke",{value:(o=e,a=r,i=n,c=f,function(e,t){if(c===p)throw Error("Generator is already running");if(c===h){if("throw"===e)throw t;return{value:s,done:!0}}for(i.method=e,i.arg=t;;){var r=i.delegate;if(r){r=function e(t,r){var n=r.method,o=t.iterator[n];if(o===s)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=s,e(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;n=d(o,t.iterator,r.arg);if("throw"===n.type)return r.method="throw",r.arg=n.arg,r.delegate=null,y;o=n.arg;return o?o.done?(r[t.resultName]=o.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=s),r.delegate=null,y):o:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}(r,i);if(r){if(r===y)continue;return r}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if(c===f)throw c=h,i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);c=p;r=d(o,a,i);if("normal"===r.type){if(c=i.done?h:m,r.arg===y)continue;return{value:r.arg,done:i.done}}"throw"===r.type&&(c=h,i.method="throw",i.arg=r.arg)}})}),t}function d(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}i.wrap=c;var f="suspendedStart",m="suspendedYield",p="executing",h="completed",y={};function v(){}function g(){}function w(){}var t={},b=(a(t,n,function(){return this}),Object.getPrototypeOf),b=b&&b(b(C([]))),x=(b&&b!==e&&u.call(b,n)&&(t=b),w.prototype=v.prototype=Object.create(t));function E(e){["next","throw","return"].forEach(function(t){a(e,t,function(e){return this._invoke(t,e)})})}function L(i,c){var t;l(this,"_invoke",{value:function(r,n){function e(){return new c(function(e,t){!function t(e,r,n,o){var a,e=d(i[e],i,r);if("throw"!==e.type)return(r=(a=e.arg).value)&&"object"==_typeof(r)&&u.call(r,"__await")?c.resolve(r.__await).then(function(e){t("next",e,n,o)},function(e){t("throw",e,n,o)}):c.resolve(r).then(function(e){a.value=e,n(a)},function(e){return t("throw",e,n,o)});o(e.arg)}(r,n,e,t)})}return t=t?t.then(e,e):e()}})}function k(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function S(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function _(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(k,this),this.reset(!0)}function C(t){if(t||""===t){var r,e=t[n];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length))return r=-1,(e=function e(){for(;++r<t.length;)if(u.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=s,e.done=!0,e}).next=e}throw new TypeError(_typeof(t)+" is not iterable")}return l(x,"constructor",{value:g.prototype=w,configurable:!0}),l(w,"constructor",{value:g,configurable:!0}),g.displayName=a(w,o,"GeneratorFunction"),i.isGeneratorFunction=function(e){e="function"==typeof e&&e.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},i.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,w):(e.__proto__=w,a(e,o,"GeneratorFunction")),e.prototype=Object.create(x),e},i.awrap=function(e){return{__await:e}},E(L.prototype),a(L.prototype,r,function(){return this}),i.AsyncIterator=L,i.async=function(e,t,r,n,o){void 0===o&&(o=Promise);var a=new L(c(e,t,r,n),o);return i.isGeneratorFunction(t)?a:a.next().then(function(e){return e.done?e.value:a.next()})},E(x),a(x,o,"Generator"),a(x,n,function(){return this}),a(x,"toString",function(){return"[object Generator]"}),i.keys=function(e){var t,r=Object(e),n=[];for(t in r)n.push(t);return n.reverse(),function e(){for(;n.length;){var t=n.pop();if(t in r)return e.value=t,e.done=!1,e}return e.done=!0,e}},i.values=C,_.prototype={constructor:_,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=s,this.done=!1,this.delegate=null,this.method="next",this.arg=s,this.tryEntries.forEach(S),!e)for(var t in this)"t"===t.charAt(0)&&u.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=s)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var n=this;function e(e,t){return a.type="throw",a.arg=r,n.next=e,t&&(n.method="next",n.arg=s),!!t}for(var t=this.tryEntries.length-1;0<=t;--t){var o=this.tryEntries[t],a=o.completion;if("root"===o.tryLoc)return e("end");if(o.tryLoc<=this.prev){var i=u.call(o,"catchLoc"),c=u.call(o,"finallyLoc");if(i&&c){if(this.prev<o.catchLoc)return e(o.catchLoc,!0);if(this.prev<o.finallyLoc)return e(o.finallyLoc)}else if(i){if(this.prev<o.catchLoc)return e(o.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return e(o.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;0<=r;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&u.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}var a=(o=o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc?null:o)?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,y):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),y},finish:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),S(r),y}},catch:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var r,n,o=this.tryEntries[t];if(o.tryLoc===e)return"throw"===(r=o.completion).type&&(n=r.arg,S(o)),n}throw Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:C(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=s),y}},i}function asyncGeneratorStep(e,t,r,n,o,a,i){try{var c=e[a](i),s=c.value}catch(e){return void r(e)}c.done?t(s):Promise.resolve(s).then(n,o)}function _asyncToGenerator(c){return function(){var e=this,i=arguments;return new Promise(function(t,r){var n=c.apply(e,i);function o(e){asyncGeneratorStep(n,t,r,o,a,"next",e)}function a(e){asyncGeneratorStep(n,t,r,o,a,"throw",e)}o(void 0)})}}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _regeneratorRuntime(){_regeneratorRuntime=function(){return i};var s,i={},e=Object.prototype,u=e.hasOwnProperty,l=Object.defineProperty||function(e,t,r){e[t]=r.value},t="function"==typeof Symbol?Symbol:{},n=t.iterator||"@@iterator",r=t.asyncIterator||"@@asyncIterator",o=t.toStringTag||"@@toStringTag";function a(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{a({},"")}catch(s){a=function(e,t,r){return e[t]=r}}function c(e,t,r,n){var o,a,i,c,t=t&&t.prototype instanceof v?t:v,t=Object.create(t.prototype),n=new _(n||[]);return l(t,"_invoke",{value:(o=e,a=r,i=n,c=f,function(e,t){if(c===p)throw Error("Generator is already running");if(c===h){if("throw"===e)throw t;return{value:s,done:!0}}for(i.method=e,i.arg=t;;){var r=i.delegate;if(r){r=function e(t,r){var n=r.method,o=t.iterator[n];if(o===s)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=s,e(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;n=d(o,t.iterator,r.arg);if("throw"===n.type)return r.method="throw",r.arg=n.arg,r.delegate=null,y;o=n.arg;return o?o.done?(r[t.resultName]=o.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=s),r.delegate=null,y):o:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}(r,i);if(r){if(r===y)continue;return r}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if(c===f)throw c=h,i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);c=p;r=d(o,a,i);if("normal"===r.type){if(c=i.done?h:m,r.arg===y)continue;return{value:r.arg,done:i.done}}"throw"===r.type&&(c=h,i.method="throw",i.arg=r.arg)}})}),t}function d(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}i.wrap=c;var f="suspendedStart",m="suspendedYield",p="executing",h="completed",y={};function v(){}function g(){}function w(){}var t={},b=(a(t,n,function(){return this}),Object.getPrototypeOf),b=b&&b(b(C([]))),x=(b&&b!==e&&u.call(b,n)&&(t=b),w.prototype=v.prototype=Object.create(t));function E(e){["next","throw","return"].forEach(function(t){a(e,t,function(e){return this._invoke(t,e)})})}function L(i,c){var t;l(this,"_invoke",{value:function(r,n){function e(){return new c(function(e,t){!function t(e,r,n,o){var a,e=d(i[e],i,r);if("throw"!==e.type)return(r=(a=e.arg).value)&&"object"==_typeof(r)&&u.call(r,"__await")?c.resolve(r.__await).then(function(e){t("next",e,n,o)},function(e){t("throw",e,n,o)}):c.resolve(r).then(function(e){a.value=e,n(a)},function(e){return t("throw",e,n,o)});o(e.arg)}(r,n,e,t)})}return t=t?t.then(e,e):e()}})}function k(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function S(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function _(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(k,this),this.reset(!0)}function C(t){if(t||""===t){var r,e=t[n];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length))return r=-1,(e=function e(){for(;++r<t.length;)if(u.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=s,e.done=!0,e}).next=e}throw new TypeError(_typeof(t)+" is not iterable")}return l(x,"constructor",{value:g.prototype=w,configurable:!0}),l(w,"constructor",{value:g,configurable:!0}),g.displayName=a(w,o,"GeneratorFunction"),i.isGeneratorFunction=function(e){e="function"==typeof e&&e.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},i.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,w):(e.__proto__=w,a(e,o,"GeneratorFunction")),e.prototype=Object.create(x),e},i.awrap=function(e){return{__await:e}},E(L.prototype),a(L.prototype,r,function(){return this}),i.AsyncIterator=L,i.async=function(e,t,r,n,o){void 0===o&&(o=Promise);var a=new L(c(e,t,r,n),o);return i.isGeneratorFunction(t)?a:a.next().then(function(e){return e.done?e.value:a.next()})},E(x),a(x,o,"Generator"),a(x,n,function(){return this}),a(x,"toString",function(){return"[object Generator]"}),i.keys=function(e){var t,r=Object(e),n=[];for(t in r)n.push(t);return n.reverse(),function e(){for(;n.length;){var t=n.pop();if(t in r)return e.value=t,e.done=!1,e}return e.done=!0,e}},i.values=C,_.prototype={constructor:_,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=s,this.done=!1,this.delegate=null,this.method="next",this.arg=s,this.tryEntries.forEach(S),!e)for(var t in this)"t"===t.charAt(0)&&u.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=s)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var n=this;function e(e,t){return a.type="throw",a.arg=r,n.next=e,t&&(n.method="next",n.arg=s),!!t}for(var t=this.tryEntries.length-1;0<=t;--t){var o=this.tryEntries[t],a=o.completion;if("root"===o.tryLoc)return e("end");if(o.tryLoc<=this.prev){var i=u.call(o,"catchLoc"),c=u.call(o,"finallyLoc");if(i&&c){if(this.prev<o.catchLoc)return e(o.catchLoc,!0);if(this.prev<o.finallyLoc)return e(o.finallyLoc)}else if(i){if(this.prev<o.catchLoc)return e(o.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return e(o.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;0<=r;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&u.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}var a=(o=o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc?null:o)?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,y):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),y},finish:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),S(r),y}},catch:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var r,n,o=this.tryEntries[t];if(o.tryLoc===e)return"throw"===(r=o.completion).type&&(n=r.arg,S(o)),n}throw Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:C(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=s),y}},i}function asyncGeneratorStep(e,t,r,n,o,a,i){try{var c=e[a](i),s=c.value}catch(e){return void r(e)}c.done?t(s):Promise.resolve(s).then(n,o)}function _asyncToGenerator(c){return function(){var e=this,i=arguments;return new Promise(function(t,r){var n=c.apply(e,i);function o(e){asyncGeneratorStep(n,t,r,o,a,"next",e)}function a(e){asyncGeneratorStep(n,t,r,o,a,"throw",e)}o(void 0)})}}document.addEventListener("click",activeDescriptionEditor),document.addEventListener("cardAdded",initDescriptionEditorCardAdded),document.addEventListener("cardViewOpened",renderDescription),document.addEventListener("click",updateDescription),jQuery(function(a){var o=document.querySelector(".kanban-card-view"),e=null==o?void 0:o.querySelector(".card-priority"),t=null==o?void 0:o.querySelector(".card-status");document.addEventListener("click",function(e){var t,r,n,o=e.target.closest(".dynamic-select-item"),e=e.target.closest(".dynamic-select-current");e?(t=(e=a(e).closest(".dynamic-select")).find(".dynamic-select-dropdown")).hasClass("active")?(t.removeClass("active"),t.slideUp(".1s"),e.removeClass("dropdown-opened")):(t.addClass("active"),t.slideDown(".1s"),e.addClass("dropdown-opened")):o||(t=a(".dynamic-select"),(e=a(".dynamic-select-dropdown")).removeClass("active"),e.slideUp(".1s"),t.removeClass("dropdown-opened")),o&&(t=(e=a(o)).closest(".dynamic-select"),o=e.data("option"),e.hasClass("active")||(a(".dynamic-select-item").removeClass("active"),e.addClass("active"),(r=t.next()).val(o),n=new CustomEvent("change",{bubbles:!0,cancelable:!0}),r[0].dispatchEvent(n)),(r=e.clone()).removeClass("active dynamic-select-item"),r.addClass("dynamic-select-current-item"),""==o&&r.find(".dynamic-select-label").addClass("dynamic-select-label--default"),n=a(".dynamic-select-current"),t.find(n).html(""),t.find(n).append(r),e=a(".dynamic-select-dropdown"),t.find(e).removeClass("active"),t.find(e).slideUp(".1s"),t.removeClass("dropdown-opened"))}),null!=e&&e.addEventListener("change",function(){setTimeout(function(){var e=document.querySelector('.kanban-card[data-card-id="'.concat(o.dataset.cardId,'"]')),t=o.querySelector(".priority-wrap .dynamic-select-current-item"),r=o.querySelector(".card-priority").selectedIndex,t=t.cloneNode(!0),n=e.querySelector(".priority-wrap .dynamic-select-current");e.querySelector(".card-priority").selectedIndex=r,n.replaceChildren(t)},100)}),null!=t&&t.addEventListener("change",function(){setTimeout(function(){var e=document.querySelector('.kanban-card[data-card-id="'.concat(o.dataset.cardId,'"]')),t=o.querySelector(".status-wrap .dynamic-select-current-item"),r=o.querySelector(".card-status").selectedIndex,t=t.cloneNode(!0),n=e.querySelector(".status-wrap .dynamic-select-current");e.querySelector(".card-status").selectedIndex=r,n.replaceChildren(t)},100)})}),jQuery(document).ready(function(e){function o(e){null!=e&&e.preventDefault(),t.classList.remove("show"),t.classList.add("hide"),document.querySelector("body").style.overflow="auto"}var t=document.querySelector(".s-tier-kanban-edit-profile"),r=document.querySelector(".edit-info"),n=document.querySelector(".edit-info-close"),a=document.querySelector(".s-tier-kanban-edit-profile form"),i=document.querySelector(".kanban-account-page .first_name"),c=document.querySelector(".kanban-account-page .last_name"),s=(jQuery.validator.addMethod("passwordRule",function(e,t){return this.optional(t)||/^(?=.*[A-Z])(?=.*\d).{8,}$/.test(e)},"Password must be minimum 8 characters long, have at least one number, and one uppercase letter. <a href='https://stierdev.com/secure-password-generator/' target='_blank'>Secure Password Generator</a>"),e(".s-tier-kanban-edit-profile form").validate({rules:{first_name:"required",last_name:"required",password:{passwordRule:!0},password_confirm:{equalTo:"#password"}},submitHandler:function(e){s(e)}}),(()=>{var t=_asyncToGenerator(_regeneratorRuntime().mark(function e(t){var r,n;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=new FormData(a),r.get("password")||(r.delete("password"),r.delete("password_confirm")),r.append("action","stk_update_user"),r.append("security",myAjax.security),e.next=7,fetch(myAjax.ajaxurl,{method:"POST",body:r});case 7:return n=e.sent,e.next=10,n.json();case 10:!0===e.sent.success&&(o(),i.textContent=r.get("first_name"),c.textContent=r.get("last_name"),Swal.fire({title:"Profile updated successfully!",timer:1e7,showConfirmButton:!1,icon:"info"}));case 12:case"end":return e.stop()}},e)}));return function(e){return t.apply(this,arguments)}})());null!=r&&r.addEventListener("click",function(e){e.preventDefault(),t.classList.remove("hide"),t.classList.add("show"),document.querySelector("body").style.overflow="hidden"}),null!=n&&n.addEventListener("click",o)}),null!=(_document$getElementB=document.getElementById("add-column-btn"))&&_document$getElementB.addEventListener("click",function(){var t;Swal.fire({input:"text",inputAttributes:{autocapitalize:"off"},inputPlaceholder:"Column Title",showCancelButton:!0,confirmButtonText:"Create Column",showLoaderOnConfirm:!0,customClass:{confirmButton:"confirm-btn",cancelButton:"cancel-btn",container:"add-column-card"},inputValidator:function(e){if(!e)return"Column name is required!"},preConfirm:(t=_asyncToGenerator(_regeneratorRuntime().mark(function e(t){return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:jQuery.ajax({url:myAjax.ajaxurl,type:"POST",data:{action:"stk_add_column",columnName:t,projectId:jQuery("#kanban-board").data("project-id"),security:myAjax.security},success:function(e){var t;e.success?((t=document.getElementById("kanban-board")).insertAdjacentHTML("beforeend",e.data.columnHtml),0<t.children.length&&(t=new CustomEvent("columnAdded",{detail:{columnID:e.data.columnID}}),document.dispatchEvent(t))):alert("Error: "+e.data.message)},error:function(){alert("There was an error adding the column. Please try again.")}});case 1:case"end":return e.stop()}},e)})),function(e){return t.apply(this,arguments)})})});var updateColumnTitle=function(e){var t,r;e.target.matches(".column-title")&&(r=(t=e.target.closest(".kanban-column")).dataset.userAdmin,"click"===e.type&&r&&(e.target.setAttribute("contenteditable","true"),e.target.focus()),"focusout"===e.type||"keydown"===e.type&&13===e.keyCode)&&(e.preventDefault(),r=t.dataset.columnId,t=e.target.textContent,r={action:"stk_update_column_title",columnId:r,security:myAjax.security,columnTitle:t},jQuery.ajax({url:myAjax.ajaxurl,type:"POST",data:r,success:function(e){e.success||console.log("Error saving title.")}}),"keydown"===e.type)&&e.target.blur()},updateStatusPriority=(document.addEventListener("click",updateColumnTitle),document.addEventListener("focusout",updateColumnTitle),document.addEventListener("keydown",updateColumnTitle),null!=(_document=document)&&null!=(_document=_document.getElementById("kanban-board"))&&_document.addEventListener("click",(()=>{var t=_asyncToGenerator(_regeneratorRuntime().mark(function e(t){var r,n,o,a;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.target.closest(".delete-column-btn"))return n=r.closest(".kanban-column"),o=n.getAttribute("data-column-id"),a=null,e.next=7,Swal.fire({title:"Delete Column?",text:"Are you sure that you want to delete this column?",icon:"warning",showDenyButton:!0,confirmButtonText:"Delete",denyButtonText:"Cancel",customClass:{confirmButton:"del-btn",denyButton:"cancel-btn"}});e.next=9;break;case 7:a=e.sent,o&&a.isConfirmed&&jQuery.ajax({url:myAjax.ajaxurl,type:"POST",data:{action:"stk_delete_column",columnId:o,security:myAjax.security},success:function(e){e.success?n.remove():alert("Error: Column could not be deleted.")},error:function(){alert("There was an error deleting the column. Please try again.")}});case 9:case"end":return e.stop()}},e)}));return function(e){return t.apply(this,arguments)}})()),document.addEventListener("click",function(n){var t;n.target.matches(".add-card-btn")&&Swal.fire({input:"text",inputAttributes:{autocapitalize:"off"},showCancelButton:!0,confirmButtonText:"Create Card",showLoaderOnConfirm:!0,inputPlaceholder:"Card Title",customClass:{confirmButton:"confirm-btn",cancelButton:"cancel-btn",container:"add-column-card"},inputValidator:function(e){if(!e)return"Card name is required!"},preConfirm:(t=_asyncToGenerator(_regeneratorRuntime().mark(function e(t){var r;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r=n.target.closest(".kanban-column").getAttribute("data-column-id"),jQuery.ajax({url:myAjax.ajaxurl,type:"POST",data:{action:"stk_add_card",columnId:r,title:t,security:myAjax.security},success:function(e){var t;e.success&&e.data&&e.data.cardId?(n.target.closest(".kanban-column").querySelector(".kanban-cards-container").insertAdjacentHTML("beforeend",e.data.cardHTML),t=new CustomEvent("cardAdded",{detail:{cardID:e.data.cardId}}),document.dispatchEvent(t)):alert("Error: "+(e.data&&e.data.message?e.data.message:"Unknown error"))},error:function(){alert("There was an error adding the card. Please try again.")}});case 2:case"end":return e.stop()}},e)})),function(e){return t.apply(this,arguments)})})}),document.addEventListener("click",(()=>{var t=_asyncToGenerator(_regeneratorRuntime().mark(function e(t){var r,n,o;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.target.matches(".delete-card-btn")||t.target.matches(".sidebar-btn-delete"))return r=t.target.closest(".kanban-card")||t.target.closest(".kanban-card-view"),n=t.target.getAttribute("data-card-id")||r.getAttribute("data-card-id"),o=null,e.next=6,Swal.fire({title:"Delete Card?",text:"Are you sure that you want to delete this card?",icon:"warning",showDenyButton:!0,confirmButtonText:"Delete",denyButtonText:"Cancel",customClass:{confirmButton:"del-btn",denyButton:"cancel-btn"}});e.next=8;break;case 6:o=e.sent,n&&o.isConfirmed&&jQuery.ajax({url:myAjax.ajaxurl,type:"POST",data:{action:"stk_delete_card",cardId:n,security:myAjax.security},success:function(e){e.success?r.classList.contains(".kanban-card")?r.remove():(document.querySelector('.kanban-card[data-card-Id="'.concat(n,'"]')).remove(),e=new CustomEvent("cardViewClosed"),document.dispatchEvent(e)):alert("Error: Card could not be deleted.")},error:function(){alert("There was an error updating status and priority")}});case 8:case"end":return e.stop()}},e)}));return function(e){return t.apply(this,arguments)}})()),function(e){var t,r;(e.target.matches(".card-status")||e.target.matches(".card-priority"))&&(t=(e=e.target.closest(".kanban-card")||e.target.closest(".kanban-card-view")).getAttribute("data-card-id"),r=e.querySelector(".card-status").value,e=e.querySelector(".card-priority").value,t)&&jQuery.ajax({url:myAjax.ajaxurl,type:"POST",data:{action:"stk_status_priority",cardId:t,security:myAjax.security,status:r,priority:e},success:function(e){console.log(e)},error:function(){console.log("There was an error deleting the card. Please try again.")}})}),updateCardTitle=(document.addEventListener("change",updateStatusPriority),function(e){var t,r,n,o,a;e.target.matches(".card-title")&&(a=(t=null!=(t=e.target.closest(".kanban-card"))?t:document.querySelector('[data-card-id="'.concat(e.target.dataset.cardId,'"]'))).dataset.userAdmin,r=t.dataset.userCreation,"click"===e.type&&(a||r)&&(e.target.setAttribute("contenteditable","true"),e.target.focus()),"focusout"===e.type||"keydown"===e.type&&13===e.keyCode)&&(e.preventDefault(),n=(t||e.target).dataset.cardId,o=e.target.textContent,a={action:"stk_card_title",cardId:n,security:myAjax.security},"card-title"===e.target.className&&(o||(e.target.textContent="Add Title"),a.title=o),jQuery.ajax({url:myAjax.ajaxurl,type:"POST",data:a,success:function(e){e.success?document.querySelector('[data-card-id="'.concat(n,'"]')).querySelector(".card-title").innerHTML=o||"Add Title":console.log("Error saving title.")}}),"keydown"===e.type)&&e.target.blur()}),sortCards=(document.addEventListener("click",updateCardTitle),document.addEventListener("focusout",updateCardTitle),document.addEventListener("keydown",updateCardTitle),jQuery(document).ready(function(e){e(".side_expander").on("click",function(){e(".side_hidden").slideToggle(),e(".user_info").toggleClass("side-open"),e(this).toggleClass("open")}),e(".top_expander_wrap").on("click",function(){e(".board-header .bottom").fadeToggle(),e(".top_expander_wrap").toggleClass("open")})}),document.addEventListener("DOMContentLoaded",function(){var e=document.getElementById("fullscreen-btn"),t=document.body;null!=e&&e.addEventListener("click",function(){document.fullscreenElement?document.exitFullscreen().then(function(){t.classList.remove("fs-active")}).catch(function(e){console.error("Error attempting to exit full-screen mode: ".concat(e.message))}):document.documentElement.requestFullscreen({navigationUI:"hide"}).then(function(){t.classList.add("fs-active")}).catch(function(e){console.error("Error attempting to enable full-screen mode: ".concat(e.message))})})}),function(e){var t=e.item.getAttribute("data-card-id"),r=e.to.closest(".kanban-column").getAttribute("data-column-id"),e=Array.from(e.to.children).map(function(e){return e.getAttribute("data-card-id")});jQuery.ajax({url:myAjax.ajaxurl,type:"POST",data:{action:"stk_move_card",cardId:t,newColumnId:r,newOrder:e,security:myAjax.security},success:function(e){e.success||console.error("Failed to move card:",e)},error:function(e,t,r){console.error("Error moving card:",t,r)}})}),sortColumns=function(e){var t=e.item.getAttribute("data-column-id"),e=Array.from(e.to.children).map(function(e){return e.getAttribute("data-column-id")});jQuery.ajax({url:myAjax.ajaxurl,type:"POST",data:{action:"stk_move_column",columnID:t,newOrder:e,security:myAjax.security},success:function(e){e.success||console.error("Failed to move column:",e)},error:function(e,t,r){console.error("Error moving column:",t,r)}})},kanbanBoard=(document.addEventListener("columnAdded",function(e){e=document.querySelector('[data-column-id="'.concat(e.detail.columnID,'"]')).querySelector(".kanban-cards-container");e&&Sortable.create(e,{group:"cards",animation:150,draggable:".kanban-card",onAdd:function(e){return sortCards(e)},onUpdate:function(e){return sortCards(e)}})},!1),document.querySelector("#kanban-board"));kanbanBoard&&Sortable.create(kanbanBoard,{group:"column",animation:150,draggable:".kanban-column",onAdd:function(e){return sortColumns(e)},onUpdate:function(e){return sortColumns(e)}}),document.querySelectorAll(".kanban-cards-container").forEach(function(e){Sortable.create(e,{group:"cards",animation:150,draggable:".kanban-card",onAdd:function(e){return sortCards(e)},onUpdate:function(e){return sortCards(e)}})});