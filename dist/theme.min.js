var cardView=function(t){var e,r,n,o,a,i,c,s;!t.target.closest(".kanban-card")||t.target.closest(".dynamic-select")||t.target.closest(".card-priority")||t.target.closest(".card-status")||t.target.closest(".delete-card-btn")||t.target.closest(".card-title")||t.target.closest("a")||(e=(c=t.target.closest(".kanban-card")).dataset.cardId,a=c.dataset.userAdmin,c=c.dataset.userCreation,o=document.querySelector(".kanban-comment-save"),i=document.querySelector(".kanban-description-save"),r=document.querySelector(".kanban-card-view"),s=t.target.closest(".kanban-card").querySelector(".card-title").innerHTML,n=document.querySelector(".kanban-card-view").querySelector(".card-title"),o.dataset.cardId=e,i.dataset.cardId=e,i.dataset.userAdmin=a,i.dataset.userCreation=c,n.innerHTML=s,n.dataset.cardId=e,r.classList.remove("hide"),r.classList.add("show"),document.querySelector("body").style.overflow="hidden",o=new CustomEvent("cardViewOpened",{detail:{cardID:e}}),document.dispatchEvent(o)),(t.target.matches(".kanban-card-view-close")||t.target.matches(".kanban-card-view"))&&(a=document.querySelector(".kanban-card-view"),i=document.querySelector(".kanban-comments"),a.classList.remove("show"),a.classList.add("hide"),document.querySelector("body").style.overflow="visible",(c=document.querySelector(".comment-error"))&&c.remove(),i.innerHTML="",s=new CustomEvent("cardViewClosed"),document.dispatchEvent(s))};function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _regeneratorRuntime(){_regeneratorRuntime=function(){return i};var s,i={},t=Object.prototype,u=t.hasOwnProperty,d=Object.defineProperty||function(t,e,r){t[e]=r.value},e="function"==typeof Symbol?Symbol:{},n=e.iterator||"@@iterator",r=e.asyncIterator||"@@asyncIterator",o=e.toStringTag||"@@toStringTag";function a(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{a({},"")}catch(s){a=function(t,e,r){return t[e]=r}}function c(t,e,r,n){var o,a,i,c,e=e&&e.prototype instanceof v?e:v,e=Object.create(e.prototype),n=new _(n||[]);return d(e,"_invoke",{value:(o=t,a=r,i=n,c=m,function(t,e){if(c===p)throw Error("Generator is already running");if(c===h){if("throw"===t)throw e;return{value:s,done:!0}}for(i.method=t,i.arg=e;;){var r=i.delegate;if(r){r=function t(e,r){var n=r.method,o=e.iterator[n];if(o===s)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=s,t(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;n=l(o,e.iterator,r.arg);if("throw"===n.type)return r.method="throw",r.arg=n.arg,r.delegate=null,y;o=n.arg;return o?o.done?(r[e.resultName]=o.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=s),r.delegate=null,y):o:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}(r,i);if(r){if(r===y)continue;return r}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if(c===m)throw c=h,i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);c=p;r=l(o,a,i);if("normal"===r.type){if(c=i.done?h:f,r.arg===y)continue;return{value:r.arg,done:i.done}}"throw"===r.type&&(c=h,i.method="throw",i.arg=r.arg)}})}),e}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}i.wrap=c;var m="suspendedStart",f="suspendedYield",p="executing",h="completed",y={};function v(){}function g(){}function b(){}var e={},w=(a(e,n,function(){return this}),Object.getPrototypeOf),w=w&&w(w(C([]))),x=(w&&w!==t&&u.call(w,n)&&(e=w),b.prototype=v.prototype=Object.create(e));function E(t){["next","throw","return"].forEach(function(e){a(t,e,function(t){return this._invoke(e,t)})})}function k(i,c){var e;d(this,"_invoke",{value:function(r,n){function t(){return new c(function(t,e){!function e(t,r,n,o){var a,t=l(i[t],i,r);if("throw"!==t.type)return(r=(a=t.arg).value)&&"object"==_typeof(r)&&u.call(r,"__await")?c.resolve(r.__await).then(function(t){e("next",t,n,o)},function(t){e("throw",t,n,o)}):c.resolve(r).then(function(t){a.value=t,n(a)},function(t){return e("throw",t,n,o)});o(t.arg)}(r,n,t,e)})}return e=e?e.then(t,t):t()}})}function S(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function L(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function _(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(S,this),this.reset(!0)}function C(e){if(e||""===e){var r,t=e[n];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return r=-1,(t=function t(){for(;++r<e.length;)if(u.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=s,t.done=!0,t}).next=t}throw new TypeError(_typeof(e)+" is not iterable")}return d(x,"constructor",{value:g.prototype=b,configurable:!0}),d(b,"constructor",{value:g,configurable:!0}),g.displayName=a(b,o,"GeneratorFunction"),i.isGeneratorFunction=function(t){t="function"==typeof t&&t.constructor;return!!t&&(t===g||"GeneratorFunction"===(t.displayName||t.name))},i.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,a(t,o,"GeneratorFunction")),t.prototype=Object.create(x),t},i.awrap=function(t){return{__await:t}},E(k.prototype),a(k.prototype,r,function(){return this}),i.AsyncIterator=k,i.async=function(t,e,r,n,o){void 0===o&&(o=Promise);var a=new k(c(t,e,r,n),o);return i.isGeneratorFunction(e)?a:a.next().then(function(t){return t.done?t.value:a.next()})},E(x),a(x,o,"Generator"),a(x,n,function(){return this}),a(x,"toString",function(){return"[object Generator]"}),i.keys=function(t){var e,r=Object(t),n=[];for(e in r)n.push(e);return n.reverse(),function t(){for(;n.length;){var e=n.pop();if(e in r)return t.value=e,t.done=!1,t}return t.done=!0,t}},i.values=C,_.prototype={constructor:_,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=s,this.done=!1,this.delegate=null,this.method="next",this.arg=s,this.tryEntries.forEach(L),!t)for(var e in this)"t"===e.charAt(0)&&u.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=s)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var n=this;function t(t,e){return a.type="throw",a.arg=r,n.next=t,e&&(n.method="next",n.arg=s),!!e}for(var e=this.tryEntries.length-1;0<=e;--e){var o=this.tryEntries[e],a=o.completion;if("root"===o.tryLoc)return t("end");if(o.tryLoc<=this.prev){var i=u.call(o,"catchLoc"),c=u.call(o,"finallyLoc");if(i&&c){if(this.prev<o.catchLoc)return t(o.catchLoc,!0);if(this.prev<o.finallyLoc)return t(o.finallyLoc)}else if(i){if(this.prev<o.catchLoc)return t(o.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return t(o.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;0<=r;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&u.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}var a=(o=o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc?null:o)?o.completion:{};return a.type=t,a.arg=e,o?(this.method="next",this.next=o.finallyLoc,y):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;0<=e;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),L(r),y}},catch:function(t){for(var e=this.tryEntries.length-1;0<=e;--e){var r,n,o=this.tryEntries[e];if(o.tryLoc===t)return"throw"===(r=o.completion).type&&(n=r.arg,L(o)),n}throw Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:C(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=s),y}},i}function asyncGeneratorStep(t,e,r,n,o,a,i){try{var c=t[a](i),s=c.value}catch(t){return void r(t)}c.done?e(s):Promise.resolve(s).then(n,o)}function _asyncToGenerator(c){return function(){var t=this,i=arguments;return new Promise(function(e,r){var n=c.apply(t,i);function o(t){asyncGeneratorStep(n,e,r,o,a,"next",t)}function a(t){asyncGeneratorStep(n,e,r,o,a,"throw",t)}o(void 0)})}}document.addEventListener("click",cardView);var commentEditors=[],editor=new EditorJS({holder:"kanban-comment-editor-js",minHeight:100,placeholder:"Post a comment...",tools:{Marker:{class:Marker,inlineToolbar:!0,shortcut:"CMD+SHIFT+M"},image:{class:SimpleImage,inlineToolbar:!0,config:{placeholder:"Paste image URL"}},code:{class:CodeTool,shortcut:"CMD+SHIFT+C"}},data:{}}),createEditorsPromise=(()=>{var t=_asyncToGenerator(_regeneratorRuntime().mark(function t(){return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.all(Array.from(document.querySelectorAll(".kanban-comment-text")).map((()=>{var e=_asyncToGenerator(_regeneratorRuntime().mark(function t(e){var r,n,o;return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(r=e.id,n=e.dataset.content,commentEditors.length&&(commentEditors.forEach(function(t){t.destroy()}),commentEditors=[]),r)return o=new EditorJS({holder:r,readOnly:!0,minHeight:0,defaultBlock:"defaultBlock",tools:{Marker:{class:Marker,inlineToolbar:!0,shortcut:"CMD+SHIFT+M"},image:{class:SimpleImage,inlineToolbar:["link"]},code:{class:CodeTool,shortcut:"CMD+SHIFT+C"},defaultBlock:DefaultBlock},data:JSON.parse(n)}),t.next=7,o.isReady;t.next=8;break;case 7:commentEditors.push(o);case 8:case"end":return t.stop()}},t)}));return function(t){return e.apply(this,arguments)}})()));case 2:return t.abrupt("return",commentEditors);case 3:case"end":return t.stop()}},t)}));return function(){return t.apply(this,arguments)}})(),findEditor=function(t,e){if(t.length)return t.filter(function(t){if(void 0!==t&&void 0!==t.configuration)return t.configuration.holder===e})},comments=function(t){t.preventDefault();var i=t.target.dataset.cardId,c=new FormData;editor.save().then((()=>{var e=_asyncToGenerator(_regeneratorRuntime().mark(function t(e){var r,n,o,a;return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(0===e.blocks.length)return t.abrupt("return");t.next=2;break;case 2:return c.append("action","stk_card_comments"),c.append("cardId",i),c.append("security",myAjax.security),c.append("comment",JSON.stringify(e,null,4)),t.next=8,fetch(myAjax.ajaxurl,{method:"POST",body:c});case 8:return r=t.sent,t.next=11,r.json();case 11:(r=t.sent)&&!0===r.success&&(getComments(i),editor.clear(),n=r.data.user_id,o=document.querySelector('[data-card-id="'.concat(i,'"]')).querySelectorAll('[data-user="'.concat(n,'"]')),a=document.querySelector('[data-card-id="'.concat(i,'"]')).querySelector(".card-members"),o.length||a.insertAdjacentHTML("beforeend",'<div data-user="'.concat(n,'" class="user-avatar">\n              ').concat(r.data.user_avatar,"\n          </div>")));case 13:case"end":return t.stop()}},t)}));return function(t){return e.apply(this,arguments)}})())},getComments=(()=>{var e=_asyncToGenerator(_regeneratorRuntime().mark(function t(e){var r,n,o,a,i;return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return(o=new FormData).append("action","stk_get_comments"),o.append("cardId",e),o.append("security",myAjax.security),r=document.querySelector(".kanban-comments"),(n=document.createElement("div")).classList.add("loader"),r.append(n),t.next=10,fetch(myAjax.ajaxurl,{method:"POST",body:o});case 10:return n=t.sent,t.next=13,n.json();case 13:if(o=t.sent,r.innerHTML="",o&&!0===o.success)if(o.data.comments){if(r.innerHTML=o.data.comments,0!==document.querySelectorAll(".kanban-comment-text").length)return t.next=22,createEditorsPromise();t.next=32}else t.next=34;else t.next=36;break;case 22:a=t.sent,i=function(t){t=findEditor(a,"comment_"+String(t.detail.commentID));void 0!==t[0]&&t[0].readOnly.toggle("",!0)},document.removeEventListener("editMode",i),document.addEventListener("editMode",i),i=function(t){t=findEditor(a,"comment_"+String(t.detail.commentID));void 0!==t[0]&&t[0].readOnly.toggle()},document.removeEventListener("discardMode",i),document.addEventListener("discardMode",i),i=function(r){var t=findEditor(a,"comment_"+String(r.detail.commentID));void 0!==t[0]&&t[0].save().then((()=>{var e=_asyncToGenerator(_regeneratorRuntime().mark(function t(e){return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(0===e.blocks.length)return t.abrupt("return");t.next=2;break;case 2:commentsAction("",!0,r.detail.commentID,JSON.stringify(e,null,4));case 3:case"end":return t.stop()}},t)}));return function(t){return e.apply(this,arguments)}})())},document.removeEventListener("commentEdited",i),document.addEventListener("commentEdited",i);case 32:t.next=36;break;case 34:document.querySelector(".no-comments")||((i=document.createElement("p")).classList.add("no-comments"),i.innerHTML="Currently, there are no comments",r.append(i));case 36:case"end":return t.stop()}},t)}));return function(t){return e.apply(this,arguments)}})(),commentsAction=(()=>{var e=_asyncToGenerator(_regeneratorRuntime().mark(function t(e){var r,n,o,a,i,c,s,u,d,l,m,f,p,h,y=arguments;return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(r=1<y.length&&void 0!==y[1]&&y[1],n=2<y.length&&void 0!==y[2]?y[2]:null,o=3<y.length&&void 0!==y[3]?y[3]:null,a=e?e.target.matches(".kanban-comment-delete"):"",i=e?e.target.matches(".kanban-comment-edit"):"",c=e?e.target.matches(".kanban-comment-edit-save"):"",s=null,a)return t.next=10,Swal.fire({title:"Delete Comment?",text:"Are you sure that you want to delete this comment?",icon:"warning",showDenyButton:!0,confirmButtonText:"Delete",denyButtonText:"Cancel",customClass:{confirmButton:"del-btn",denyButton:"cancel-btn"}});t.next=11;break;case 10:s=t.sent;case 11:if(i)return u=e.target.dataset.commentId,u=new CustomEvent("editMode",{detail:{commentID:u}}),document.dispatchEvent(u),t.abrupt("return");t.next=16;break;case 16:if(c)return u=e.target.dataset.commentId,d=new CustomEvent("commentEdited",{detail:{commentID:u}}),document.dispatchEvent(d),t.abrupt("return");t.next=21;break;case 21:if(a&&s.isConfirmed||r)return d=new FormData,l=e?e.target.dataset.commentId:n,d.append("action","stk_comments_actions"),d.append("commentAction",a?"delete":"edit"),d.append("commentID",l),d.append("security",myAjax.security),null!==d&&d.append("comment",o),t.next=31,fetch(myAjax.ajaxurl,{method:"POST",body:d});t.next=36;break;case 31:return m=t.sent,t.next=34,m.json();case 34:(m=t.sent)&&!0===m.success&&(a?(p=e.target.closest(".kanban-comment"),f=p.dataset.userId,h=p.dataset.cardId,p.remove(),document.querySelectorAll('.kanban-comments [data-user-id="'.concat(f,'"]')).length||document.querySelector('.kanban-card[data-card-id="'.concat(h,'"]')).querySelector('.card-members [data-user="'.concat(f,'"]')).remove(),0===document.querySelectorAll(".kanban-comment").length&&(p=document.createElement("p"),h=document.querySelector(".kanban-comments"),p.classList.add("no-comments"),p.innerHTML="Currently, there are no comments",h.append(p))):discardEditMode("",l));case 36:case"end":return t.stop()}},t)}));return function(t){return e.apply(this,arguments)}})(),editMode=function(t){var t="#comment_"+String(t.detail.commentID),e=document.querySelector(t),t=document.querySelector(t).parentElement;t.querySelector(".kanban-comment-buttons-edit-mode").style.display="block",t.querySelector(".kanban-comment-buttons").style.display="none",e.classList.add("edit-mode")},discardEditMode=function(t){var e,r,n=1<arguments.length&&void 0!==arguments[1]&&arguments[1];(t?t.target.matches(".kanban-comment-discard"):n)&&(r="#comment_"+String(t?t.target.dataset.commentId:n),e=document.querySelector(r),(r=document.querySelector(r).parentElement).querySelector(".kanban-comment-buttons-edit-mode").style.display="none",r.querySelector(".kanban-comment-buttons").style.display="block",e.classList.remove("edit-mode"),r=new CustomEvent("discardMode",{detail:{commentID:t?t.target.dataset.commentId:n}}),document.dispatchEvent(r))},commentsSave=(document.addEventListener("cardViewOpened",function(t){return getComments(t.detail.cardID)}),document.addEventListener("cardViewClosed",function(t){return editor.clear()}),document.querySelector(".kanban-comment-save"));function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _regeneratorRuntime(){_regeneratorRuntime=function(){return i};var s,i={},t=Object.prototype,u=t.hasOwnProperty,d=Object.defineProperty||function(t,e,r){t[e]=r.value},e="function"==typeof Symbol?Symbol:{},n=e.iterator||"@@iterator",r=e.asyncIterator||"@@asyncIterator",o=e.toStringTag||"@@toStringTag";function a(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{a({},"")}catch(s){a=function(t,e,r){return t[e]=r}}function c(t,e,r,n){var o,a,i,c,e=e&&e.prototype instanceof v?e:v,e=Object.create(e.prototype),n=new _(n||[]);return d(e,"_invoke",{value:(o=t,a=r,i=n,c=m,function(t,e){if(c===p)throw Error("Generator is already running");if(c===h){if("throw"===t)throw e;return{value:s,done:!0}}for(i.method=t,i.arg=e;;){var r=i.delegate;if(r){r=function t(e,r){var n=r.method,o=e.iterator[n];if(o===s)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=s,t(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;n=l(o,e.iterator,r.arg);if("throw"===n.type)return r.method="throw",r.arg=n.arg,r.delegate=null,y;o=n.arg;return o?o.done?(r[e.resultName]=o.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=s),r.delegate=null,y):o:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}(r,i);if(r){if(r===y)continue;return r}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if(c===m)throw c=h,i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);c=p;r=l(o,a,i);if("normal"===r.type){if(c=i.done?h:f,r.arg===y)continue;return{value:r.arg,done:i.done}}"throw"===r.type&&(c=h,i.method="throw",i.arg=r.arg)}})}),e}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}i.wrap=c;var m="suspendedStart",f="suspendedYield",p="executing",h="completed",y={};function v(){}function g(){}function b(){}var e={},w=(a(e,n,function(){return this}),Object.getPrototypeOf),w=w&&w(w(C([]))),x=(w&&w!==t&&u.call(w,n)&&(e=w),b.prototype=v.prototype=Object.create(e));function E(t){["next","throw","return"].forEach(function(e){a(t,e,function(t){return this._invoke(e,t)})})}function k(i,c){var e;d(this,"_invoke",{value:function(r,n){function t(){return new c(function(t,e){!function e(t,r,n,o){var a,t=l(i[t],i,r);if("throw"!==t.type)return(r=(a=t.arg).value)&&"object"==_typeof(r)&&u.call(r,"__await")?c.resolve(r.__await).then(function(t){e("next",t,n,o)},function(t){e("throw",t,n,o)}):c.resolve(r).then(function(t){a.value=t,n(a)},function(t){return e("throw",t,n,o)});o(t.arg)}(r,n,t,e)})}return e=e?e.then(t,t):t()}})}function S(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function L(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function _(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(S,this),this.reset(!0)}function C(e){if(e||""===e){var r,t=e[n];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return r=-1,(t=function t(){for(;++r<e.length;)if(u.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=s,t.done=!0,t}).next=t}throw new TypeError(_typeof(e)+" is not iterable")}return d(x,"constructor",{value:g.prototype=b,configurable:!0}),d(b,"constructor",{value:g,configurable:!0}),g.displayName=a(b,o,"GeneratorFunction"),i.isGeneratorFunction=function(t){t="function"==typeof t&&t.constructor;return!!t&&(t===g||"GeneratorFunction"===(t.displayName||t.name))},i.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,a(t,o,"GeneratorFunction")),t.prototype=Object.create(x),t},i.awrap=function(t){return{__await:t}},E(k.prototype),a(k.prototype,r,function(){return this}),i.AsyncIterator=k,i.async=function(t,e,r,n,o){void 0===o&&(o=Promise);var a=new k(c(t,e,r,n),o);return i.isGeneratorFunction(e)?a:a.next().then(function(t){return t.done?t.value:a.next()})},E(x),a(x,o,"Generator"),a(x,n,function(){return this}),a(x,"toString",function(){return"[object Generator]"}),i.keys=function(t){var e,r=Object(t),n=[];for(e in r)n.push(e);return n.reverse(),function t(){for(;n.length;){var e=n.pop();if(e in r)return t.value=e,t.done=!1,t}return t.done=!0,t}},i.values=C,_.prototype={constructor:_,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=s,this.done=!1,this.delegate=null,this.method="next",this.arg=s,this.tryEntries.forEach(L),!t)for(var e in this)"t"===e.charAt(0)&&u.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=s)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var n=this;function t(t,e){return a.type="throw",a.arg=r,n.next=t,e&&(n.method="next",n.arg=s),!!e}for(var e=this.tryEntries.length-1;0<=e;--e){var o=this.tryEntries[e],a=o.completion;if("root"===o.tryLoc)return t("end");if(o.tryLoc<=this.prev){var i=u.call(o,"catchLoc"),c=u.call(o,"finallyLoc");if(i&&c){if(this.prev<o.catchLoc)return t(o.catchLoc,!0);if(this.prev<o.finallyLoc)return t(o.finallyLoc)}else if(i){if(this.prev<o.catchLoc)return t(o.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return t(o.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;0<=r;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&u.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}var a=(o=o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc?null:o)?o.completion:{};return a.type=t,a.arg=e,o?(this.method="next",this.next=o.finallyLoc,y):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;0<=e;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),L(r),y}},catch:function(t){for(var e=this.tryEntries.length-1;0<=e;--e){var r,n,o=this.tryEntries[e];if(o.tryLoc===t)return"throw"===(r=o.completion).type&&(n=r.arg,L(o)),n}throw Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:C(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=s),y}},i}function asyncGeneratorStep(t,e,r,n,o,a,i){try{var c=t[a](i),s=c.value}catch(t){return void r(t)}c.done?e(s):Promise.resolve(s).then(n,o)}function _asyncToGenerator(c){return function(){var t=this,i=arguments;return new Promise(function(e,r){var n=c.apply(t,i);function o(t){asyncGeneratorStep(n,e,r,o,a,"next",t)}function a(t){asyncGeneratorStep(n,e,r,o,a,"throw",t)}o(void 0)})}}commentsSave.addEventListener("click",comments),document.addEventListener("editMode",editMode),document.addEventListener("click",commentsAction),document.addEventListener("click",discardEditMode);var descriptionIcon='<svg width="14" height="18" viewBox="0 0 14 18" fill="none" xmlns="http://www.w3.org/2000/svg">\n\t\t\t\t\t<path d="M13.25 10.875V8.6875C13.25 7.94158 12.9537 7.22621 12.4262 6.69876C11.8988 6.17132 11.1834 5.875 10.4375 5.875H9.1875C8.93886 5.875 8.7004 5.77623 8.52459 5.60041C8.34877 5.4246 8.25 5.18614 8.25 4.9375V3.6875C8.25 2.94158 7.95368 2.22621 7.42624 1.69876C6.89879 1.17132 6.18342 0.875 5.4375 0.875H3.875M3.875 11.5H10.125M3.875 14H7M5.75 0.875H1.6875C1.17 0.875 0.75 1.295 0.75 1.8125V16.1875C0.75 16.705 1.17 17.125 1.6875 17.125H12.3125C12.83 17.125 13.25 16.705 13.25 16.1875V8.375C13.25 6.38588 12.4598 4.47822 11.0533 3.0717C9.64678 1.66518 7.73912 0.875 5.75 0.875Z" stroke="#808890" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path>\n\t\t\t\t</svg>',checkForEmptyObject=function(t){for(var e in t)if(t.hasOwnProperty(e))return!1;return!0},descriptionEditors=[],createEditorsPromiseDescription=(()=>{var t=_asyncToGenerator(_regeneratorRuntime().mark(function t(){return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.all(Array.from(document.querySelectorAll(".card-description")).map((()=>{var e=_asyncToGenerator(_regeneratorRuntime().mark(function t(e){var r,n,o;return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(o=e.id,r=JSON.parse(e.dataset.description),descriptionEditors.length&&(descriptionEditors.forEach(function(t){t.destroy()}),descriptionEditors=[]),o)return n=new EditorJS({holder:o,readOnly:!0,minHeight:100,defaultBlock:"defaultBlock",tools:{Marker:{class:Marker,inlineToolbar:!0,shortcut:"CMD+SHIFT+M"},image:{class:SimpleImage,inlineToolbar:["link"]},code:{class:CodeTool,shortcut:"CMD+SHIFT+C"},defaultBlock:{class:DefaultBlock}},data:r}),!0!==checkForEmptyObject(r)&&0!==r.blocks.length||((o=document.createElement("span")).innerHTML="Add a description",o.classList.add("description-placeholder"),e.before(o)),t.next=8,n.isReady;t.next=9;break;case 8:descriptionEditors.push(n);case 9:case"end":return t.stop()}},t)}));return function(t){return e.apply(this,arguments)}})()));case 2:return t.abrupt("return",descriptionEditors);case 3:case"end":return t.stop()}},t)}));return function(){return t.apply(this,arguments)}})(),descriptionEditor=new EditorJS({holder:"description-editor-js",minHeight:100,placeholder:"Write a description...",readOnly:!0,tools:{Marker:{class:Marker,inlineToolbar:!0,shortcut:"CMD+SHIFT+M"},image:{class:SimpleImage,inlineToolbar:!0,config:{placeholder:"Paste image URL"}},code:{class:CodeTool,shortcut:"CMD+SHIFT+C"}},data:{}}),activeDescriptionEditor=function(t){var e=document.querySelector(".kanban-card-view-description-editor"),r=document.querySelector(".kanban-description-save"),n=r.dataset.userAdmin,o=r.dataset.userCreation;t.target.closest(".kanban-card-view-description-editor")?e.classList.contains("active")||!o&&!n||(e.classList.add("active"),descriptionEditor.readOnly.toggle(),r.style.display="inline-block"):e.classList.contains("active")&&!t.target.matches(".kanban-description-save")&&(e.classList.remove("active"),descriptionEditor.readOnly.toggle(),r.style.display="none")},updateDescription=function(t){var a,i;t.target.matches(".kanban-description-save")&&(t.preventDefault(),a=t.target.dataset.cardId,i=new FormData,descriptionEditor.save().then((()=>{var e=_asyncToGenerator(_regeneratorRuntime().mark(function t(e){var r,n,o;return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return i.append("action","stk_card_description_save"),i.append("cardId",a),i.append("security",myAjax.security),i.append("description",JSON.stringify(e,null,4)),t.next=6,fetch(myAjax.ajaxurl,{method:"POST",body:i});case 6:return n=t.sent,t.next=9,n.json();case 9:(r=t.sent)&&!0===r.success&&(0!==descriptionEditors.length&&descriptionEditors.map(function(t){var e=t.configuration.holder.split("-");parseInt(e[e.length-1])==a&&((e=document.querySelector('[data-card-id="'.concat(a,'"]'))).querySelector(".card-svgs").innerHTML=descriptionIcon,e.querySelector(".card-description").dataset.description=r.data.description,e=JSON.parse(r.data.description),t.render(e),t=document.querySelector(".kanban-card-view-description-editor"),e=document.querySelector(".kanban-description-save"),t.classList.remove("active"),descriptionEditor.readOnly.toggle(),e.style.display="none")}),n=document.querySelector('[data-card-id="'.concat(a,'"]')),(o=n.querySelector(".description-placeholder"))&&o.remove(),0===JSON.parse(r.data.description).blocks.length)&&((o=document.createElement("span")).innerHTML="Add a description",o.classList.add("description-placeholder"),n.querySelector(".card-description").before(o));case 11:case"end":return t.stop()}},t)}));return function(t){return e.apply(this,arguments)}})()))},initDescriptionEditors=(()=>{var t=_asyncToGenerator(_regeneratorRuntime().mark(function t(){return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,createEditorsPromiseDescription();case 2:case"end":return t.stop()}},t)}));return function(){return t.apply(this,arguments)}})(),renderDescription=(initDescriptionEditors(),function(t){t=document.querySelector('[data-card-id="'.concat(t.detail.cardID,'"]')).querySelector(".card-description").dataset.description;(t=JSON.parse(t))&&!checkForEmptyObject(t)?descriptionEditor.render(t):descriptionEditor.clear()}),initDescriptionEditorCardAdded=function(t){var t=t.detail.cardID,t=document.querySelector('[data-card-id="'.concat(t,'"]')).querySelector(".card-description"),e=new EditorJS({holder:t.id,readOnly:!0,minHeight:100,defaultBlock:!1,tools:{Marker:{class:Marker,inlineToolbar:!0,shortcut:"CMD+SHIFT+M"},image:{class:SimpleImage,inlineToolbar:["link"]},code:{class:CodeTool,shortcut:"CMD+SHIFT+C"}},data:{}}),r=document.createElement("span");r.innerHTML="Add a description",r.classList.add("description-placeholder"),t.before(r),descriptionEditors.push(e)};function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _regeneratorRuntime(){_regeneratorRuntime=function(){return i};var s,i={},t=Object.prototype,u=t.hasOwnProperty,d=Object.defineProperty||function(t,e,r){t[e]=r.value},e="function"==typeof Symbol?Symbol:{},n=e.iterator||"@@iterator",r=e.asyncIterator||"@@asyncIterator",o=e.toStringTag||"@@toStringTag";function a(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{a({},"")}catch(s){a=function(t,e,r){return t[e]=r}}function c(t,e,r,n){var o,a,i,c,e=e&&e.prototype instanceof v?e:v,e=Object.create(e.prototype),n=new _(n||[]);return d(e,"_invoke",{value:(o=t,a=r,i=n,c=m,function(t,e){if(c===p)throw Error("Generator is already running");if(c===h){if("throw"===t)throw e;return{value:s,done:!0}}for(i.method=t,i.arg=e;;){var r=i.delegate;if(r){r=function t(e,r){var n=r.method,o=e.iterator[n];if(o===s)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=s,t(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;n=l(o,e.iterator,r.arg);if("throw"===n.type)return r.method="throw",r.arg=n.arg,r.delegate=null,y;o=n.arg;return o?o.done?(r[e.resultName]=o.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=s),r.delegate=null,y):o:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}(r,i);if(r){if(r===y)continue;return r}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if(c===m)throw c=h,i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);c=p;r=l(o,a,i);if("normal"===r.type){if(c=i.done?h:f,r.arg===y)continue;return{value:r.arg,done:i.done}}"throw"===r.type&&(c=h,i.method="throw",i.arg=r.arg)}})}),e}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}i.wrap=c;var m="suspendedStart",f="suspendedYield",p="executing",h="completed",y={};function v(){}function g(){}function b(){}var e={},w=(a(e,n,function(){return this}),Object.getPrototypeOf),w=w&&w(w(C([]))),x=(w&&w!==t&&u.call(w,n)&&(e=w),b.prototype=v.prototype=Object.create(e));function E(t){["next","throw","return"].forEach(function(e){a(t,e,function(t){return this._invoke(e,t)})})}function k(i,c){var e;d(this,"_invoke",{value:function(r,n){function t(){return new c(function(t,e){!function e(t,r,n,o){var a,t=l(i[t],i,r);if("throw"!==t.type)return(r=(a=t.arg).value)&&"object"==_typeof(r)&&u.call(r,"__await")?c.resolve(r.__await).then(function(t){e("next",t,n,o)},function(t){e("throw",t,n,o)}):c.resolve(r).then(function(t){a.value=t,n(a)},function(t){return e("throw",t,n,o)});o(t.arg)}(r,n,t,e)})}return e=e?e.then(t,t):t()}})}function S(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function L(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function _(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(S,this),this.reset(!0)}function C(e){if(e||""===e){var r,t=e[n];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return r=-1,(t=function t(){for(;++r<e.length;)if(u.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=s,t.done=!0,t}).next=t}throw new TypeError(_typeof(e)+" is not iterable")}return d(x,"constructor",{value:g.prototype=b,configurable:!0}),d(b,"constructor",{value:g,configurable:!0}),g.displayName=a(b,o,"GeneratorFunction"),i.isGeneratorFunction=function(t){t="function"==typeof t&&t.constructor;return!!t&&(t===g||"GeneratorFunction"===(t.displayName||t.name))},i.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,a(t,o,"GeneratorFunction")),t.prototype=Object.create(x),t},i.awrap=function(t){return{__await:t}},E(k.prototype),a(k.prototype,r,function(){return this}),i.AsyncIterator=k,i.async=function(t,e,r,n,o){void 0===o&&(o=Promise);var a=new k(c(t,e,r,n),o);return i.isGeneratorFunction(e)?a:a.next().then(function(t){return t.done?t.value:a.next()})},E(x),a(x,o,"Generator"),a(x,n,function(){return this}),a(x,"toString",function(){return"[object Generator]"}),i.keys=function(t){var e,r=Object(t),n=[];for(e in r)n.push(e);return n.reverse(),function t(){for(;n.length;){var e=n.pop();if(e in r)return t.value=e,t.done=!1,t}return t.done=!0,t}},i.values=C,_.prototype={constructor:_,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=s,this.done=!1,this.delegate=null,this.method="next",this.arg=s,this.tryEntries.forEach(L),!t)for(var e in this)"t"===e.charAt(0)&&u.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=s)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var n=this;function t(t,e){return a.type="throw",a.arg=r,n.next=t,e&&(n.method="next",n.arg=s),!!e}for(var e=this.tryEntries.length-1;0<=e;--e){var o=this.tryEntries[e],a=o.completion;if("root"===o.tryLoc)return t("end");if(o.tryLoc<=this.prev){var i=u.call(o,"catchLoc"),c=u.call(o,"finallyLoc");if(i&&c){if(this.prev<o.catchLoc)return t(o.catchLoc,!0);if(this.prev<o.finallyLoc)return t(o.finallyLoc)}else if(i){if(this.prev<o.catchLoc)return t(o.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return t(o.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;0<=r;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&u.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}var a=(o=o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc?null:o)?o.completion:{};return a.type=t,a.arg=e,o?(this.method="next",this.next=o.finallyLoc,y):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;0<=e;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),L(r),y}},catch:function(t){for(var e=this.tryEntries.length-1;0<=e;--e){var r,n,o=this.tryEntries[e];if(o.tryLoc===t)return"throw"===(r=o.completion).type&&(n=r.arg,L(o)),n}throw Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:C(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=s),y}},i}function asyncGeneratorStep(t,e,r,n,o,a,i){try{var c=t[a](i),s=c.value}catch(t){return void r(t)}c.done?e(s):Promise.resolve(s).then(n,o)}function _asyncToGenerator(c){return function(){var t=this,i=arguments;return new Promise(function(e,r){var n=c.apply(t,i);function o(t){asyncGeneratorStep(n,e,r,o,a,"next",t)}function a(t){asyncGeneratorStep(n,e,r,o,a,"throw",t)}o(void 0)})}}document.addEventListener("click",activeDescriptionEditor),document.addEventListener("cardAdded",initDescriptionEditorCardAdded),document.addEventListener("cardViewOpened",renderDescription),document.addEventListener("click",updateDescription),jQuery(function(a){document.addEventListener("click",function(t){var e,r,n,o=t.target.closest(".dynamic-select-item"),t=t.target.closest(".dynamic-select-current");t?(e=(t=a(t).closest(".dynamic-select")).find(".dynamic-select-dropdown")).hasClass("active")?(e.removeClass("active"),e.slideUp(".4s"),t.removeClass("dropdown-opened")):(e.addClass("active"),e.slideDown(".4s"),t.addClass("dropdown-opened")):o||(e=a(".dynamic-select"),(t=a(".dynamic-select-dropdown")).removeClass("active"),t.slideUp(".4s"),e.removeClass("dropdown-opened")),o&&(e=(t=a(o)).closest(".dynamic-select"),o=t.data("option"),t.hasClass("active")||(a(".dynamic-select-item").removeClass("active"),t.addClass("active"),(r=e.next()).val(o),n=new CustomEvent("change",{bubbles:!0,cancelable:!0}),r[0].dispatchEvent(n)),(r=t.clone()).removeClass("active dynamic-select-item"),r.addClass("dynamic-select-current-item"),""==o&&r.find(".dynamic-select-label").addClass("dynamic-select-label--default"),n=a(".dynamic-select-current"),e.find(n).html(""),e.find(n).append(r),t=a(".dynamic-select-dropdown"),e.find(t).removeClass("active"),e.find(t).slideUp(".4s"),e.removeClass("dropdown-opened"))})}),document.getElementById("add-column-btn").addEventListener("click",function(){var e;Swal.fire({input:"text",inputAttributes:{autocapitalize:"off"},inputPlaceholder:"Column Title",showCancelButton:!0,confirmButtonText:"Create Column",showLoaderOnConfirm:!0,customClass:{confirmButton:"confirm-btn",cancelButton:"cancel-btn",container:"add-column-card"},inputValidator:function(t){if(!t)return"Column name is required!"},preConfirm:(e=_asyncToGenerator(_regeneratorRuntime().mark(function t(e){return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:jQuery.ajax({url:myAjax.ajaxurl,type:"POST",data:{action:"stk_add_column",columnName:e,projectId:jQuery("#kanban-board").data("project-id"),security:myAjax.security},success:function(t){var e;t.success?((e=document.getElementById("kanban-board")).insertAdjacentHTML("beforeend",t.data.columnHtml),0<e.children.length&&(e=new CustomEvent("columnAdded",{detail:{columnID:t.data.columnID}}),document.dispatchEvent(e))):alert("Error: "+t.data.message)},error:function(){alert("There was an error adding the column. Please try again.")}});case 1:case"end":return t.stop()}},t)})),function(t){return e.apply(this,arguments)})})});var updateColumnTitle=function(t){var e,r;t.target.matches(".column-title")&&(r=(e=t.target.closest(".kanban-column")).dataset.userAdmin,"click"===t.type&&r&&(t.target.setAttribute("contenteditable","true"),t.target.focus()),"focusout"===t.type||"keydown"===t.type&&13===t.keyCode)&&(t.preventDefault(),r=e.dataset.columnId,e=t.target.textContent,r={action:"stk_update_column_title",columnId:r,security:myAjax.security,columnTitle:e},jQuery.ajax({url:myAjax.ajaxurl,type:"POST",data:r,success:function(t){t.success||console.log("Error saving title.")}}),"keydown"===t.type)&&t.target.blur()},updateStatusPriority=(document.addEventListener("click",updateColumnTitle),document.addEventListener("focusout",updateColumnTitle),document.addEventListener("keydown",updateColumnTitle),document.getElementById("kanban-board").addEventListener("click",(()=>{var e=_asyncToGenerator(_regeneratorRuntime().mark(function t(e){var r,n,o,a;return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(r=e.target.closest(".delete-column-btn"))return n=r.closest(".kanban-column"),o=n.getAttribute("data-column-id"),a=null,t.next=7,Swal.fire({title:"Delete Column?",text:"Are you sure that you want to delete this column?",icon:"warning",showDenyButton:!0,confirmButtonText:"Delete",denyButtonText:"Cancel",customClass:{confirmButton:"del-btn",denyButton:"cancel-btn"}});t.next=9;break;case 7:a=t.sent,o&&a.isConfirmed&&jQuery.ajax({url:myAjax.ajaxurl,type:"POST",data:{action:"stk_delete_column",columnId:o,security:myAjax.security},success:function(t){t.success?n.remove():alert("Error: Column could not be deleted.")},error:function(){alert("There was an error deleting the column. Please try again.")}});case 9:case"end":return t.stop()}},t)}));return function(t){return e.apply(this,arguments)}})()),document.addEventListener("click",function(n){var e;n.target.matches(".add-card-btn")&&Swal.fire({input:"text",inputAttributes:{autocapitalize:"off"},showCancelButton:!0,confirmButtonText:"Create Card",showLoaderOnConfirm:!0,inputPlaceholder:"Card Title",customClass:{confirmButton:"confirm-btn",cancelButton:"cancel-btn",container:"add-column-card"},inputValidator:function(t){if(!t)return"Card name is required!"},preConfirm:(e=_asyncToGenerator(_regeneratorRuntime().mark(function t(e){var r;return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:r=n.target.closest(".kanban-column").getAttribute("data-column-id"),jQuery.ajax({url:myAjax.ajaxurl,type:"POST",data:{action:"stk_add_card",columnId:r,title:e,security:myAjax.security},success:function(t){var e;t.success&&t.data&&t.data.cardId?(n.target.closest(".kanban-column").querySelector(".kanban-cards-container").insertAdjacentHTML("beforeend",t.data.cardHTML),e=new CustomEvent("cardAdded",{detail:{cardID:t.data.cardId}}),document.dispatchEvent(e)):alert("Error: "+(t.data&&t.data.message?t.data.message:"Unknown error"))},error:function(){alert("There was an error adding the card. Please try again.")}});case 2:case"end":return t.stop()}},t)})),function(t){return e.apply(this,arguments)})})}),document.addEventListener("click",(()=>{var e=_asyncToGenerator(_regeneratorRuntime().mark(function t(e){var r,n,o;return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e.target.matches(".delete-card-btn"))return r=e.target.closest(".kanban-card"),n=e.target.getAttribute("data-card-id"),o=null,t.next=6,Swal.fire({title:"Delete Card?",text:"Are you sure that you want to delete this card?",icon:"warning",showDenyButton:!0,confirmButtonText:"Delete",denyButtonText:"Cancel",customClass:{confirmButton:"del-btn",denyButton:"cancel-btn"}});t.next=8;break;case 6:o=t.sent,n&&o.isConfirmed&&jQuery.ajax({url:myAjax.ajaxurl,type:"POST",data:{action:"stk_delete_card",cardId:n,security:myAjax.security},success:function(t){t.success?r.remove():alert("Error: Card could not be deleted.")},error:function(){alert("There was an error updating status and priority")}});case 8:case"end":return t.stop()}},t)}));return function(t){return e.apply(this,arguments)}})()),function(t){var e,r;(t.target.matches(".card-status")||t.target.matches(".card-priority"))&&(e=(t=t.target.closest(".kanban-card")).getAttribute("data-card-id"),r=t.querySelector(".card-status").value,t=t.querySelector(".card-priority").value,e)&&jQuery.ajax({url:myAjax.ajaxurl,type:"POST",data:{action:"stk_status_priority",cardId:e,security:myAjax.security,status:r,priority:t},success:function(t){console.log(t)},error:function(){console.log("There was an error deleting the card. Please try again.")}})}),updateCardTitle=(document.addEventListener("change",updateStatusPriority),function(t){var e,r,n,o,a;t.target.matches(".card-title")&&(a=(e=null!=(e=t.target.closest(".kanban-card"))?e:document.querySelector('[data-card-id="'.concat(t.target.dataset.cardId,'"]'))).dataset.userAdmin,r=e.dataset.userCreation,"click"===t.type&&(a||r)&&(t.target.setAttribute("contenteditable","true"),t.target.focus()),"focusout"===t.type||"keydown"===t.type&&13===t.keyCode)&&(t.preventDefault(),n=(e||t.target).dataset.cardId,o=t.target.textContent,a={action:"stk_card_title",cardId:n,security:myAjax.security},"card-title"===t.target.className&&(o||(t.target.textContent="Add Title"),a.title=o),jQuery.ajax({url:myAjax.ajaxurl,type:"POST",data:a,success:function(t){t.success?document.querySelector('[data-card-id="'.concat(n,'"]')).querySelector(".card-title").innerHTML=o||"Add Title":console.log("Error saving title.")}}),"keydown"===t.type)&&t.target.blur()}),sortCards=(document.addEventListener("click",updateCardTitle),document.addEventListener("focusout",updateCardTitle),document.addEventListener("keydown",updateCardTitle),jQuery(document).ready(function(t){t(".side_expander").on("click",function(){t(".side_hidden").slideToggle(),t(".user_info").toggleClass("side-open"),t(this).toggleClass("open")}),t(".top_expander_wrap").on("click",function(){t(".board-header .bottom").slideToggle(),t(".top_expander_wrap").toggleClass("open")})}),function(t){var e=t.item.getAttribute("data-card-id"),r=t.to.closest(".kanban-column").getAttribute("data-column-id"),t=Array.from(t.to.children).map(function(t){return t.getAttribute("data-card-id")});jQuery.ajax({url:myAjax.ajaxurl,type:"POST",data:{action:"stk_move_card",cardId:e,newColumnId:r,newOrder:t,security:myAjax.security},success:function(t){t.success||console.error("Failed to move card:",t)},error:function(t,e,r){console.error("Error moving card:",e,r)}})}),sortColumns=function(t){var e=t.item.getAttribute("data-column-id"),t=Array.from(t.to.children).map(function(t){return t.getAttribute("data-column-id")});jQuery.ajax({url:myAjax.ajaxurl,type:"POST",data:{action:"stk_move_column",columnID:e,newOrder:t,security:myAjax.security},success:function(t){t.success||console.error("Failed to move column:",t)},error:function(t,e,r){console.error("Error moving column:",e,r)}})};document.addEventListener("columnAdded",function(t){t=document.querySelector('[data-column-id="'.concat(t.detail.columnID,'"]')).querySelector(".kanban-cards-container");Sortable.create(t,{group:"cards",animation:150,draggable:".kanban-card",onAdd:function(t){return sortCards(t)},onUpdate:function(t){return sortCards(t)}})},!1),Sortable.create(document.querySelector("#kanban-board"),{group:"column",animation:150,draggable:".kanban-column",onAdd:function(t){return sortColumns(t)},onUpdate:function(t){return sortColumns(t)}}),document.querySelectorAll(".kanban-cards-container").forEach(function(t){Sortable.create(t,{group:"cards",animation:150,draggable:".kanban-card",onAdd:function(t){return sortCards(t)},onUpdate:function(t){return sortCards(t)}})});